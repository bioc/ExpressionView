<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>PDF.as</title>
<link rel="stylesheet" type="text/css" href="../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/*
_________________            __________________________
___    |__  /__(_)__   _________  __ \__  __ \__  ____/
__  /| |_  /__  /__ | / /  _ \_  /_/ /_  / / /_  /_    
_  ___ |  / _  / __ |/ //  __/  ____/_  /_/ /_  __/
/_/  |_/_/  /_/  _____/ \___//_/     /_____/ /_/  
     
Copyright (c) 2008 Thibault Imbert

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/</span>

<span class="ActionScriptASDoc">/**
* This library lets you generate PDF files with the Flash Player
* AlivePDF is based on the FPDF PHP library by Olivier Plathey (http://www.fpdf.org/)
* Core Team : Thibault Imbert, Mark Lynch, Alexandre Pires, Marc Hugues, christoph.k
* @version 0.1.4.9 Current Release
* @url alivepdf.bytearray.org
*/</span>

<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pdf</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BitmapData</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DisplayObject</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Event</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EventDispatcher</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IEventDispatcher</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Matrix</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Point</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Rectangle</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">net</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">URLRequest</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">net</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">URLRequestHeader</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">net</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">URLRequestMethod</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">net</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">navigateToURL</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ByteArray</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dictionary</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getTimer</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cells</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CellVO</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">colors</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CMYKColor</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">colors</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Color</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">colors</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GrayColor</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">colors</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RGBColor</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Grid</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GridColumn</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Display</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PageMode</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">drawing</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Caps</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">drawing</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DashedLine</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">drawing</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">WindingRule</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">encoding</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Base64</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">encoding</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">JPEGEncoder</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">encoding</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PNGEncoder</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PageEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ProcessingEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fonts</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CoreFonts</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fonts</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FontFamily</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fonts</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FontType</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fonts</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Style</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">html</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">HTMLTag</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">images</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GIFImage</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">images</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ImageFormat</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">images</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ImageHeader</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">images</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">JPEGImage</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">images</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PDFImage</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">images</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PNGImage</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">images</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ResizeMode</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Align</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Layout</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Size</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">layout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Unit</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">metrics</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FontMetrics</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Page</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">saving</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Method</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alivepdf</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tools</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sprintf</span>;

    <span class="ActionScriptASDoc">/**
     * Dispatched when a page has been added to the PDF. The addPage() method generate this event
     *
     * @eventType org.alivepdf.events.PageEvent.ADDED
     *
     * * @example
     * This example shows how to listen for such an event :
     * &lt;div class="listing"&gt;
     * &lt;pre&gt;
     *
     * myPDF.addEventListener ( PageEvent.ADDED, pageAdded );
     * &lt;/pre&gt;
     * &lt;/div&gt;
      */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'added'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'org.alivepdf.events.PageEvent'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptASDoc">/**
     * Dispatched when PDF has been generated and available. The save() method generate this event
     *
     * @eventType org.alivepdf.events.ProcessingEvent.COMPLETE
     *
     * * @example
     * This example shows how to listen for such an event :
     * &lt;div class="listing"&gt;
     * &lt;pre&gt;
     *
     * myPDF.addEventListener ( ProcessingEvent.COMPLETE, generationComplete );
     * &lt;/pre&gt;
     * &lt;/div&gt;
      */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'complete'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'org.alivepdf.events.ProcessingEvent'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptASDoc">/**
     * Dispatched when the PDF page tree has been generated. The save() method generate this event
     *
     * @eventType org.alivepdf.events.ProcessingEvent.PAGE_TREE
     *
     * * @example
     * This example shows how to listen for such an event :
     * &lt;div class="listing"&gt;
     * &lt;pre&gt;
     *
     * myPDF.addEventListener ( ProcessingEvent.PAGE_TREE, pageTreeAdded );
     * &lt;/pre&gt;
     * &lt;/div&gt;
      */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'pageTree'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'org.alivepdf.events.ProcessingEvent'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptASDoc">/**
     * Dispatched when the required resources (fonts, images, etc.) haven been written into the PDF. The save() method generate this event
     *
     * @eventType org.alivepdf.events.ProcessingEvent.RESOURCES
     *
     * * @example
     * This example shows how to listen for such an event :
     * &lt;div class="listing"&gt;
     * &lt;pre&gt;
     *
     * myPDF.addEventListener ( ProcessingEvent.RESOURCES, resourcesAdded );
     * &lt;/pre&gt;
     * &lt;/div&gt;
      */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'resources'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'org.alivepdf.events.ProcessingEvent'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptASDoc">/**
     * Dispatched when the PDF generation has been initiated. The save() method generate this event
     *
     * @eventType org.alivepdf.events.ProcessingEvent.STARTED
     *
     * * @example
     * This example shows how to listen for such an event :
     * &lt;div class="listing"&gt;
     * &lt;pre&gt;
     *
     * myPDF.addEventListener ( ProcessingEvent.STARTED, generationStarted );
     * &lt;/pre&gt;
     * &lt;/div&gt;
      */</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'started'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'org.alivepdf.events.ProcessingEvent'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>

    <span class="ActionScriptASDoc">/**
    * The PDF class represents a PDF document.
    */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">PDF</span> <span class="ActionScriptReserved">implements</span> <span class="ActionScriptDefault_Text">IEventDispatcher</span>
    <span class="ActionScriptBracket/Brace">{</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">PDF_VERSION</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'1.3'</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">ALIVEPDF_VERSION</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'0.1.4.8'</span>;

        <span class="ActionScriptComment">//current page number
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nbPages</span>:<span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptComment">//current object number
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">n</span>:<span class="ActionScriptDefault_Text">int</span>;      
        <span class="ActionScriptComment">//array of object offsets            
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">offsets</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptComment">//current document state        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">state</span>:<span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptComment">//compression flag        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">compress</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptComment">//default orientation        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">defaultOrientation</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//default format  
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">defaultSize</span>:<span class="ActionScriptDefault_Text">Size</span>;
        <span class="ActionScriptComment">//default rotation  
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">defaultRotation</span>:<span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptComment">//default unit  
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">defaultUnit</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//current orientation
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentOrientation</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//array indicating orientation changes 
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">orientationChanges</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptComment">//scale factor (number of points in user unit)
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//left margin             
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lMargin</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//top margin           
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tMargin</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//right margin       
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rMargin</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//page break margin          
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bMargin</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//cell margin      
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cMargin</span>:<span class="ActionScriptDefault_Text">Number</span>;            
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentX</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentY</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//last cell printed
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lasth</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//line width in user unit        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lineWidth</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//array of standard font names       
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">standardFonts</span>:<span class="ActionScriptDefault_Text">Object</span>;
        <span class="ActionScriptComment">//array of used fonts        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fonts</span>:<span class="ActionScriptDefault_Text">Object</span>;
        <span class="ActionScriptComment">//array of font files          
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontFiles</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptComment">//array of encoding differences         
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">diffs</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptComment">//array of internal links            
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">links</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptComment">//current font family              
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontFamily</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//current font style         
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontStyle</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//underlining flag        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">underline</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptComment">//current font size in points        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontSizePt</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//commands for drawing color        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">strokeStyle</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//winding number rule
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">windingRule</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//commands for filling color        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fillColor</span>:<span class="ActionScriptDefault_Text">String</span>;   
        <span class="ActionScriptComment">//commands for text color       
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">addTextColor</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//indicates whether fill and text colors are different        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">colorFlag</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptComment">//word spacing       
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ws</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//automatic page breaking      
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">autoPageBreak</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptComment">//threshold used to trigger page breaks
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pageBreakTrigger</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptComment">//flag set when processing header
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">inHeader</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptComment">//flag set when processing footer
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">inFooter</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptComment">//zoom display mode       
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">zoomMode</span>:<span class="ActionScriptOperator">*</span>;
        <span class="ActionScriptComment">//layout display mode         
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">layoutMode</span>:<span class="ActionScriptDefault_Text">String</span>;         
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pageMode</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//document infos
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">documentTitle</span>:<span class="ActionScriptDefault_Text">String</span>;            
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">documentSubject</span>:<span class="ActionScriptDefault_Text">String</span>;       
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">documentAuthor</span>:<span class="ActionScriptDefault_Text">String</span>;      
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">documentKeywords</span>:<span class="ActionScriptDefault_Text">String</span>;    
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">documentCreator</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//alias for total number of pages        
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">aliasNbPages</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">//PDF version number      
</span>        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pdfVersion</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">buffer</span>:<span class="ActionScriptDefault_Text">ByteArray</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">streamDictionary</span>:<span class="ActionScriptDefault_Text">Dictionary</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">compressedPages</span>:<span class="ActionScriptDefault_Text">ByteArray</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">encryptRef</span>:<span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">image</span>:<span class="ActionScriptDefault_Text">PDFImage</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontSize</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">name</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">type</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">desc</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">up</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ut</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cw</span>:<span class="ActionScriptDefault_Text">Object</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">enc</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">diff</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">d</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nb</span>:<span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">originalsize</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">size1</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">size2</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontkey</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">file</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentFont</span>:<span class="ActionScriptDefault_Text">Object</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b2</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pageLinks</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">filter</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">inited</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">filled</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dispatcher</span>:<span class="ActionScriptDefault_Text">EventDispatcher</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">arrayPages</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">arrayNotes</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">extgstates</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentPage</span>:<span class="ActionScriptDefault_Text">Page</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">outlines</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rotationMatrix</span>:<span class="ActionScriptDefault_Text">Matrix</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">outlineRoot</span>:<span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">angle</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textRendering</span>:<span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">autoPagination</span>:<span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">viewerPreferences</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">drawingRule</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">reference</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">references</span>:<span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">zoomFactor</span>:<span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">zoomRectangle</span>:<span class="ActionScriptDefault_Text">Rectangle</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">columns</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentGrid</span>:<span class="ActionScriptDefault_Text">Grid</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">isEven</span>:<span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">columnNames</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">matrix</span>:<span class="ActionScriptDefault_Text">Matrix</span>;

        <span class="ActionScriptASDoc">/**
        * The PDF class represents a PDF document.
        *
        * @author Thibault Imbert
        *
        * @example
        * This example shows how to create a valid PDF document :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * var myPDF:PDF = new PDF ( Orientation.PORTRAIT, Unit.MM, Size.A4 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">PDF</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">orientation</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'Portrait'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">unit</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'Mm'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">pageSize</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rotation</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0 <span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span> 
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">format</span>:<span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">size</span>:<span class="ActionScriptDefault_Text">Size</span>;
            
            <span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">=</span> 2;
            <span class="ActionScriptDefault_Text">angle</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">state</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">lasth</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">fontSizePt</span> <span class="ActionScriptOperator">=</span> 12;
            <span class="ActionScriptDefault_Text">ws</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptDefault_Text">size</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">pageSize</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">Size</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pageSize</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clone</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">Size</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">A4</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">clone</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">size</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span>  <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RangeError</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'Unknown page format : '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">pageSize</span> <span class="ActionScriptOperator">+</span><span class="ActionScriptString">', please use a org.alivepdf.layout.'</span> <span class="ActionScriptOperator">+</span> 
                                                            <span class="ActionScriptString">'Size object or any of those strings : A3, A4, A5, Letter, Legal, Tabloid'</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">dispatcher</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">EventDispatcher</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">this</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">viewerPreferences</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">outlines</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">arrayPages</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">arrayNotes</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">extgstates</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">orientationChanges</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">nbPages</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptDefault_Text">buffer</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">offsets</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">fonts</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">pageLinks</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">fontFiles</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">diffs</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">streamDictionary</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">rotationMatrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Matrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">links</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">inHeader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">inFooter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">fontFamily</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">fontStyle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">underline</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">strokeStyle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0 G'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">fillColor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0 g'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0 g'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">colorFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">inited</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">references</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">compressedPages</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Matrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">//Standard fonts
</span>            <span class="ActionScriptDefault_Text">standardFonts</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">CoreFonts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// Scaling factor
</span>            <span class="ActionScriptDefault_Text">defaultUnit</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">setUnit</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">unit</span> <span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptComment">// format &amp; orientation
</span>            <span class="ActionScriptDefault_Text">defaultSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">size</span>;
            <span class="ActionScriptDefault_Text">defaultOrientation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">orientation</span>;
            <span class="ActionScriptDefault_Text">defaultRotation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rotation</span>;

            <span class="ActionScriptComment">//Page margins (1 cm)
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">margin</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 28.35<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptDefault_Text">setMargins</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">margin</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">margin</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">//Interior cell margin (1 mm)
</span>            <span class="ActionScriptDefault_Text">cMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">margin</span><span class="ActionScriptOperator">/</span>10;

            <span class="ActionScriptComment">//Line width (0.2 mm)
</span>            <span class="ActionScriptDefault_Text">lineWidth</span> <span class="ActionScriptOperator">=</span> .567<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">k</span>;

            <span class="ActionScriptComment">//Automatic page break
</span>            <span class="ActionScriptDefault_Text">setAutoPageBreak</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">margin</span> <span class="ActionScriptOperator">*</span> 2 <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">//Full width display mode
</span>            <span class="ActionScriptDefault_Text">setDisplayMode</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">Display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FULL_WIDTH</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// enable zlib compression
</span>            <span class="ActionScriptDefault_Text">isCompressed</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;

            <span class="ActionScriptComment">//Set default PDF version number
</span>            <span class="ActionScriptDefault_Text">pdfVersion</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">PDF</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PDF_VERSION</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you specify the left, top, and right margins
        *
        * @param left Left margin
        * @param top Right number
        * @param right Top number
        * @param bottom Bottom number
        * @example
        * This example shows how to set margins for the PDF document :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setMargins ( 10, 10, 10, 10 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setMargins</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">left</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">top</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">right</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>-1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">bottom</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>20 <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">lMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">left</span>;
            <span class="ActionScriptDefault_Text">tMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">top</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">left</span>;
            <span class="ActionScriptDefault_Text">bMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">bottom</span>;
            <span class="ActionScriptDefault_Text">rMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">right</span>;
            <span class="ActionScriptDefault_Text">setXY</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">left</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">top</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you retrieve the margins dimensions
        *
        * @return Rectangle
        * @example
        * This example shows how to get the margins dimensions :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * var marginsDimensions:Rectangle = myPDF.getMargins ();
        * // output : (x=10.00, y=10.0012, w=575.27, h=811.88)
        * trace( marginsDimensions )
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getMargins</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Rectangle</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">lMargin</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tMargin</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">getCurrentPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">rMargin</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">lMargin</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">getCurrentPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bMargin</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">tMargin</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you specify the left margin
        *
        * @param margin Left margin
        * @example
        * This example shows how set left margin for the PDF document :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setLeftMargin ( 10 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setLeftMargin</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">margin</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">lMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">margin</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">nbPages</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">margin</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">margin</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you specify the top margin
        *
        * @param margin Top margin
        * @example
        * This example shows how set top margin for the PDF document :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setTopMargin ( 10 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setTopMargin</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">margin</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">tMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">margin</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you specify the bottom margin
        *
        * @param margin Bottom margin
        * @example
        * This example shows how set bottom margin for the PDF document :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setBottomMargin ( 10 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setBottomMargin</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">margin</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">bMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">margin</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you specify the right margin
        *
        * @param margin Right margin
        * @example
        * This example shows how set right margin for the PDF document :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setRightMargin ( 10 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setRightMargin</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">margin</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">rMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">margin</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * Lets you enable or disable auto page break mode and triggering margin 
         * 
         * @param auto Page break mode
         * @param margin Bottom margin
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setAutoPageBreak</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">auto</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">margin</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">autoPageBreak</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">auto</span>;
            <span class="ActionScriptDefault_Text">bMargin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">margin</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">currentPage</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">pageBreakTrigger</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">margin</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you set a specific display mode, the DisplayMode takes care of the general layout of the PDF in the PDF reader
        *
        * @param zoom Zoom mode, can be Display.FULL_PAGE, Display.FULL_WIDTH, Display.REAL, Display.DEFAULT
        * @param layout Layout of the PDF document, can be Layout.SINGLE_PAGE, Layout.ONE_COLUMN, Layout.TWO_COLUMN_LEFT, Layout.TWO_COLUMN_RIGHT
        * @param mode PageMode can be pageMode.USE_NONE, PageMode.USE_OUTLINES, PageMode.USE_THUMBS, PageMode.FULL_SCREEN
        * @example
        * This example creates a PDF which opens at full page scaling, one page at a time :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setDisplayMode (Display.FULL_PAGE, Layout.SINGLE_PAGE);
        * &lt;/pre&gt;
        * &lt;/div&gt;
        * To create a full screen PDF you would write :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        * 
        * myPDF.setDisplayMode( Display.FULL_PAGE, Layout.SINGLE_PAGE, PageMode.FULLSCREEN );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setDisplayMode</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">zoomStyle</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'FullWidth'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">layout</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'SinglePage'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">mode</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'UseNone'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">zoomValue</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rectangle</span>:<span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">zoomMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">zoomStyle</span>;
            <span class="ActionScriptDefault_Text">zoomFactor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">zoomValue</span>;
            <span class="ActionScriptDefault_Text">zoomRectangle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rectangle</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">rectangle</span> : <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Rectangle</span> <span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">layoutMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">layout</span>;
            <span class="ActionScriptDefault_Text">pageMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">mode</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you set a title for the PDF
        *
        * @param title The title
        * @example
        * This example shows how to set a specific title to the PDF tags :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setTitle ( "AlivePDF !" );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setTitle</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">title</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">documentTitle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">title</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you set a subject for the PDF
        *
        * @param subject The subject
        * @example
        *  This example shows how to set a specific subject to the PDF tags :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setSubject ( "Any topic" );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setSubject</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">subject</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">documentSubject</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">subject</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Sets the specified author for the PDF
        *
        * @param author The author
        * @example
        * This example shows how to add a specific author to the PDF tags :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setAuthor ( "Bob" );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setAuthor</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">author</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">documentAuthor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">author</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Sets the specified keywords for the PDF
        *
        * @param keywords The keywords
        * @example
        * This example shows how to add some keywords to the PDF tags :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setKeywords ( "Design, Agency, Communication, etc." );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setKeywords</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">keywords</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">documentKeywords</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">keywords</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Sets the specified creator for the PDF
        *
        * @param creator Name of the PDF creator
        * @example
        * This example shows how to set a creator name to the PDF tags :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setCreator ( "My Application 1.0" );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setCreator</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">creator</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">documentCreator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">creator</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF compression API
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        
        <span class="ActionScriptASDoc">/**
         * Lets you activate zlib compression for the current PDF
         *   
         * @param compressed
         * @example
         * This example shows how to activate zlib compression :
         * &lt;div class="listing"&gt;
         * &lt;pre&gt;
         *
         * myPDF.isCompressed = true;
         * &lt;/pre&gt;
         * &lt;/div&gt;
         */</span>    
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">set</span> <span class="ActionScriptDefault_Text">isCompressed</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">compressed</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">compress</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">compressed</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">isCompressed</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">compress</span>;    
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF paging API
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>
        <span class="ActionScriptASDoc">/**
        * Lets you specify an alias for the total number of pages
        *
        * @param alias Alias to use
        * @example
        * This example shows how to show the total number of pages :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setAliasNbPages ( "[nb]" );
        * myPDF.textStyle( new RGBColor (0,0,0), 1 );
        * myPDF.setFont( FontFamily.HELVETICA, Style.NORMAL, 18 );
        * // then use the alias when needed
        * myPDF.addText ("There are [nb] pages in the PDF !", 150, 50);
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setAliasNbPages</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">alias</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'{nb}'</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">aliasNbPages</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">alias</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you rotate a specific page (between 1 and n-1)
        *
        * @param number Page number
        * @param rotation Page rotation (must be a multiple of 90)
        * @throws RangeError
        * @example
        * This example shows how to rotate the first page 90 clock wise :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.rotatePage ( 1, 90 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        * This example shows how to rotate the first page 90 counter clock wise :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.rotatePage ( 1, -90 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
         * 
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">rotatePage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">number</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rotation</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">number</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">number</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">number</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rotate</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">rotation</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RangeError</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"No page available, please select a page from 1 to "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Lets you add a page to the current PDF
         *  
         * @param page
         * @example
         * 
         * This example shows how to add an A4 page with a landscape orientation :
         * &lt;div class="listing"&gt;
         * &lt;pre&gt;
         *
         * var page:Page = new Page ( Orientation.LANDSCAPE, Unit.MM, Size.A4 );
         * myPDF.addPage( page );
         * &lt;/pre&gt;
         * &lt;/div&gt;
         * This example shows how to add a page with a custom size :
         * &lt;div class="listing"&gt;
         * &lt;pre&gt;
         *
         * var customSize:Size = new Size ( [420.94, 595.28], "CustomSize", [5.8,  8.3], [148, 210] );
         * var page:Page = new Page ( Orientation.PORTRAIT, Unit.MM, customSize );
         * myPDF.addPage ( page );
         * &lt;/pre&gt;
         * &lt;/div&gt;
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addPage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span>:<span class="ActionScriptDefault_Text">Page</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Page</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Page</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">defaultOrientation</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultUnit</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultSize</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultRotation</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptDefault_Text">reference</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span>3<span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nbPages</span><span class="ActionScriptOperator">&lt;&lt;</span> 1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span>;
            
            <span class="ActionScriptDefault_Text">references</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">reference</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'\n'</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">state</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">open</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">family</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fontFamily</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fontStyle</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">underline</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">'U'</span> : <span class="ActionScriptString">''</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">size</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fontSizePt</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lw</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lineWidth</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dc</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">strokeStyle</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fc</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fillColor</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tc</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">addTextColor</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cf</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">colorFlag</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">nbPages</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">inFooter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">footer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">inFooter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptDefault_Text">finishPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptComment">//Start new page
</span>            <span class="ActionScriptDefault_Text">currentPage</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">startPage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">orientation</span> : <span class="ActionScriptDefault_Text">defaultOrientation</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//Set line cap style to square
</span>            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">Caps</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SQUARE</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//Set line width
</span>            <span class="ActionScriptDefault_Text">lineWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lw</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f w'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">lw</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//Set font
</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">setFont</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">family</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">size</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//Set colors
</span>            <span class="ActionScriptDefault_Text">strokeStyle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dc</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">dc</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptString">'0 G'</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dc</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">fillColor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fc</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">fc</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptString">'0 g'</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fc</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tc</span>;
            <span class="ActionScriptDefault_Text">colorFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cf</span>;
            
            <span class="ActionScriptComment">//Page header
</span>            <span class="ActionScriptDefault_Text">inHeader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">header</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">inHeader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            
            <span class="ActionScriptComment">//Restore line width
</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lineWidth</span><span class="ActionScriptOperator">!=</span><span class="ActionScriptDefault_Text">lw</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">lineWidth</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">lw</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f w'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">lw</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">//Restore font
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">setFont</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">family</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">size</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//Restore colors
</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">strokeStyle</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">dc</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">strokeStyle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dc</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dc</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fillColor</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">fc</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">fillColor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fc</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fc</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">tc</span>;
            <span class="ActionScriptDefault_Text">colorFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cf</span>;
            
            <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PageEvent</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">PageEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ADDED</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">currentPage</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                        
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">page</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you retrieve a Page object
        *
        * @param page page number, from 1 to total numbers of pages
        * @return Page
        * @example
        * This example shows how to retrieve the first page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * var page:Page = myPDF.getPage ( 1 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getPage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Page</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">arrayPages</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RangeError</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Can't retrieve page "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"."</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
        * Lets you retrieve all the PDF pages
        *
        * @return Array
        * @example
        * This example shows how to retrieve all the PDF pages :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * var pdfPages:Array = myPDF.getPages ();
        *
        * for each ( var p:* in pdfPages ) trace( p );
        * 
        * outputs :
        * 
        * [Page orientation=Portrait width=210 height=297]
        * [Page orientation=Landscape width=297 height=210]
        * 
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getPages</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Array</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">arrayPages</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RangeError</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"No pages available !"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
        * Lets you move to a Page in the PDF
        *
        * @param page page number, from 1 to total numbers of pages
        * @example
        * This example shows how to move to the first page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.gotoPage ( 1 );
        * // draw on the first page
        * myPDF.lineStyle( new RGBColor(0xFF0000), 2, 0 );
        * myPDF.drawRect( 60, 60, 40, 40 ); 
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">gotoPage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">currentPage</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RangeError</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Can't find page "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"."</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you remove a Page from the PDF
        *
        * @param page page number, from 1 to total numbers of pages
        * @return Page
        * @example
        * This example shows how to remove the first page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        * myPDF.removePage ( 1 );
        * &lt;/pre&gt;
        * If you want to remove pages each by each, you can combine removePage with getPageCount
        * &lt;pre&gt;
        * myPDF.removePage ( myPDFEncoder.getPageCount() );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removePage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Page</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">splice</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptOperator">,</span> 1 <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RangeError</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Cannot remove page "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"."</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
        * Lets you remove all the pages from the PDF
        *
        * @example
        * This example shows how to remove all the pages :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        * myPDF.removeAllPages();
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removeAllPages</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> 
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptDefault_Text">arrayPages</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;    
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you retrieve the current Page
        *
        * @return Page A Page object
        * @example
        * This example shows how to retrieve the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * var page:Page = myPDF.getCurrentPage ();
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getCurrentPage</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Page</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">currentPage</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RangeError</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Can't retrieve the current page, "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" pages available."</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you retrieve the number of pages in the PDF document
        *
        * @return int Number of pages in the PDF
        * @example
        * This example shows how to retrieve the number of pages :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * var totalPages:int = myPDF.getPageCount ();
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">totalPages</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">int</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
        * Lets you insert a line break for text
        *
        * @param height Line break height
        * @example
        * This example shows how to add a line break :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.newLine ( 10 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">newLine</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptOperator">*</span>=<span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
            <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">lasth</span> : <span class="ActionScriptDefault_Text">height</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you retrieve the X position for the current page
        *
        * @return Number the X position
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getX</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">currentX</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you retrieve the Y position for the current page
        *
        * @return Number the Y position
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getY</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">currentY</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you specify the X position for the current page
        *
        * @param x The X position
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setX</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">&gt;=</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">x</span> : <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">x</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you specify the Y position for the current page
        *
        * @param y The Y position
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setY</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
            <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">&gt;=</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">y</span> : <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you specify the X and Y position for the current page
        *
        * @param x The X position
        * @param y The Y position
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setXY</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">setY</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">setX</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Returns the default PDF Size
         * 
         * @return Size
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getDefaultSize</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Size</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">defaultSize</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Returns the default PDF orientation
         * 
         * @return String
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getDefaultOrientation</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">defaultOrientation</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Returns the default PDF unit unit
         * 
         * @return String
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getDefaultUnit</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">defaultUnit</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF Header and Footer API
        *
        * header()
        * footer()
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">header</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">/* to be overriden (uncomment for a demo )
            this.setFont( FontFamily.ARIAL, Style.BOLD, 10 );
            this.addCell(80);
            this.addCell(30,10,'Title',1,0,'C');
            this.newLine(20);*/</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">footer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">/* to be overriden (uncomment for a demo )
            this.setY (-15);
            this.setFont( FontFamily.ARIAL, Style.ITALIC, 8 );
            this.addCell(0,10,'Page '+totalPages,0,0,'C');
            this.newLine(20);*/</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF Drawing API
        *
        * moveTo()
        * lineTo()
        * end()
        * curveTo()
        * lineStyle()
        * beginFill()
        * endFill()
        * drawRect()
        * drawRoundRect()
        * drawCircle()
        * drawEllipse()
        * drawPolygone()
        * drawRegularPolygone()
        * drawPath()
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>
        <span class="ActionScriptASDoc">/**
        * Lets you specify the opacity for the next drawing operations, from 0 (100% transparent) to 1 (100% opaque)
        *
        * @param alpha Opacity
        * @param blendMode Blend mode, can be Blend.DIFFERENCE, BLEND.HARDLIGHT, etc.
        * @example
        * This example shows how to set the transparency to 50% for any following drawing, image or text operation :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setAlpha ( .5 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>    
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setAlpha</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">alpha</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blendMode</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'Normal'</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">graphicState</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">addExtGState</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptString">'ca'</span> : <span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">'SA'</span> : <span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">'CA'</span> : <span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">'BM'</span> : <span class="ActionScriptString">'/'</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">blendMode</span> <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">setExtGState</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">graphicState</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you move the current drawing point to the specified destination
        *
        * @param x X position
        * @param y Y position
        * @example
        * This example shows how to move the pen to 120,200 :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.moveTo ( 120, 200 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">moveTo</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" m"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you draw a stroke from the current point to the new point
        *
        * @param x X position
        * @param y Y position
        * @example
        * This example shows how to draw some dashed lines in the current page with specific caps style and joint style :
        * &lt;br&gt;&lt;b&gt;Important : Always call the end() method when you're done&lt;/b&gt;
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.lineStyle( new RGBColor ( 0x990000 ), 1, 1 );
        * myPDF.moveTo ( 10, 20 );
        * myPDF.lineTo ( 40, 20 );
        * myPDF.lineTo ( 40, 40 );
        * myPDF.lineTo ( 10, 40 );
        * myPDF.lineTo ( 10, 20 );
        * myPDF.end();
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">lineTo</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" l"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * The end method closes the stroke
        *
        * @example
        * This example shows how to draw some dashed lines in the current page with specific caps style and joint style :
        * &lt;br&gt;&lt;b&gt;Important : Always call the end() method when you're done&lt;/b&gt;
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        * 
        * myPDF.lineStyle( new RGBColor ( 0x990000 ), 1, 1 );
        * myPDF.moveTo ( 10, 20 );
        * myPDF.lineTo ( 40, 20 );
        * myPDF.lineTo ( 40, 40 );
        * myPDF.lineTo ( 10, 40 );
        * myPDF.lineTo ( 10, 20 );
        * // end the stroke
        * myPDF.end();
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">end</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">filled</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">"s"</span> : <span class="ActionScriptDefault_Text">windingRule</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">WindingRule</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NON_ZERO</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">"b"</span> : <span class="ActionScriptString">"b*"</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * The curveTo method draws a cubic bezier curve
        * @param controlX1
        * @param controlY1
        * @param controlX2
        * @param controlY2
        * @param finalX3
        * @param finalY3
        * @example
        * This example shows how to draw some curves lines in the current page :
        * &lt;br&gt;&lt;b&gt;Important : Always call the end() method when you're done&lt;/b&gt;
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.lineStyle ( new RGBColor ( 0x990000 ), 1, 1, null, CapsStyle.NONE, JointStyle.MITER );
        * myPDF.moveTo ( 10, 200 );
        * myPDF.curveTo ( 120, 210, 196, 280, 139, 195 );
        * myPDF.curveTo ( 190, 110, 206, 190, 179, 205 );
        * myPDF.end();
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>    
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">curveTo</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">controlX1</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">controlY1</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">controlX2</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">controlY2</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">finalX3</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">finalY3</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">controlX1</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">controlY1</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">controlX2</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">controlY2</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">finalX3</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">finalY3</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" c"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Sets the stroke style
        * @param color
        * @param thickness
        * @param flatness
        * @param alpha
        * @param rule
        * @param blendMode
        * @param style
        * @param caps
        * @param joints
        * @param miterLimit
        * @example
        * This example shows how to draw a star with an "even odd" rule :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.lineStyle( new RGBColor ( 0x990000 ), 1, 0, 1, Rule.EVEN_ODD, null, null, Caps.NONE, Joint.MITER );
        * 
        * myPDF.beginFill( new RGBColor ( 0x009900 ) );
        * myPDF.moveTo ( 66, 10 );
        * myPDF.lineTo ( 23, 127 );
        * myPDF.lineTo ( 122, 50 );
        * myPDF.lineTo ( 10, 49 );
        * myPDF.lineTo ( 109, 127 );
        * myPDF.end();
        * 
        * &lt;/pre&gt;
        * &lt;/div&gt;
        * This example shows how to draw a star with an "non-zero" winding rule :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.lineStyle( new RGBColor ( 0x990000 ), 1, 0, 1, Rule.NON_ZERO_WINDING, null, null, Caps.NONE, Joint.MITER );
        * 
        * myPDF.beginFill( new RGBColor ( 0x009900 ) );
        * myPDF.moveTo ( 66, 10 );
        * myPDF.lineTo ( 23, 127 );
        * myPDF.lineTo ( 122, 50 );
        * myPDF.lineTo ( 10, 49 );
        * myPDF.lineTo ( 109, 127 );
        * myPDF.end();
        * 
        * &lt;/pre&gt;
        * &lt;/div&gt;
         * 
        */</span>    
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">lineStyle</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">Color</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">thickness</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">flatness</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">alpha</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rule</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"NonZeroWinding"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blendMode</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"Normal"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">DashedLine</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">caps</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">joints</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">miterLimit</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>3 <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">strokeColor</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">windingRule</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rule</span>;
            <span class="ActionScriptDefault_Text">lineWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">thickness</span>;
            <span class="ActionScriptDefault_Text">setAlpha</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blendMode</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">nbPages</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">sprintf</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f w'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">thickness</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">flatness</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" i "</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">style</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pattern</span> : <span class="ActionScriptString">'[] 0 d'</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">caps</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">caps</span> <span class="ActionScriptBracket/Brace">)</span>;            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">joints</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">joints</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">miterLimit</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" M"</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Sets the stroke color for different color spaces CMYK, RGB and DEVICEGRAY
        */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">strokeColor</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">Color</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">op</span>:<span class="ActionScriptDefault_Text">String</span>;

            <span class="ActionScriptComment">// RGB ColorSpace
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">RGBColor</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"RG"</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">/</span>255;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">g</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">g</span><span class="ActionScriptOperator">/</span>255;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">/</span>255;

                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">g</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">// CMYK ColorSpace
</span>            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">CMYKColor</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"K"</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cyan</span> <span class="ActionScriptOperator">/</span> 100;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">magenta</span> <span class="ActionScriptOperator">/</span> 100;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">yellow</span> <span class="ActionScriptOperator">/</span> 100;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">black</span> <span class="ActionScriptOperator">/</span> 100;

                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">// Gray ColorSpace
</span>            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"G"</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">gray</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">GrayColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">gray</span> <span class="ActionScriptOperator">/</span> 100;

                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">gray</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Sets the text color for different color spaces CMYK, RGB, and DEVICEGRAY
        * @param
        */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textColor</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">Color</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">op</span>:<span class="ActionScriptDefault_Text">String</span>;

            <span class="ActionScriptComment">// RGB ColorSpace
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">RGBColor</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">textRendering</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">"rg"</span> : <span class="ActionScriptString">"RG"</span>

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">/</span>255;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">g</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">g</span><span class="ActionScriptOperator">/</span>255;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">/</span>255;

                <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">g</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">op</span>;

            <span class="ActionScriptComment">// CMYK ColorSpace
</span>            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">CMYKColor</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">textRendering</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">"k"</span> : <span class="ActionScriptString">"K"</span>

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cyan</span> <span class="ActionScriptOperator">/</span> 100;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">magenta</span> <span class="ActionScriptOperator">/</span> 100;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">yellow</span> <span class="ActionScriptOperator">/</span> 100;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">black</span> <span class="ActionScriptOperator">/</span> 100;

                <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">op</span>;

            <span class="ActionScriptComment">// Gray ColorSpace
</span>            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">textRendering</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">"g"</span> : <span class="ActionScriptString">"G"</span>

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">gray</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">GrayColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">gray</span> <span class="ActionScriptOperator">/</span> 100;

                <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">gray</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">op</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Sets the filling color for different color spaces CMYK/RGB/DEVICEGRAY
        *
        * @param color Color object, can be CMYKColor, GrayColor, or RGBColor
        * @example
        * This example shows how to create a red rectangle in the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.beginFill ( new RGBColor ( 0x990000 ) );
        * myPDF.drawRect ( new Rectangle ( 10, 26, 50, 25 ) );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">beginFill</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">Color</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">filled</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">op</span>:<span class="ActionScriptDefault_Text">String</span>;

            <span class="ActionScriptComment">// RGB ColorSpace
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">RGBColor</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"rg"</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">/</span>255;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">g</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">g</span><span class="ActionScriptOperator">/</span>255;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">/</span>255;

                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">g</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">// CMYK ColorSpace
</span>            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">CMYKColor</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"k"</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cyan</span> <span class="ActionScriptOperator">/</span> 100;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">magenta</span> <span class="ActionScriptOperator">/</span> 100;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">yellow</span> <span class="ActionScriptOperator">/</span> 100;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CMYKColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">black</span> <span class="ActionScriptOperator">/</span> 100;

                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">m</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">// Gray ColorSpace
</span>            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"g"</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">gray</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">GrayColor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">gray</span> <span class="ActionScriptOperator">/</span> 100;

                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">gray</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Ends all previous filling
        *
        * @example
        * This example shows how to create a red rectangle in the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.beginFill ( new RGBColor ( 0x990000 ) );
        * myPDF.moveTo ( 10, 10 );
        * myPDF.lineTo ( 20, 90 );
        * myPDF.lineTo ( 90, 50);
        * myPDF.end()
        * myPDF.endFill();
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">endFill</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">filled</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * The drawRect method draws a rectangle shape
        * @param rect A flash.geom.Rectange object
        * @example
        * This example shows how to create a blue rectangle in the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.lineStyle ( new RGBColor ( 0x990000 ), 1, .3, null, CapsStyle.ROUND, JointStyle.MITER );
        * myPDF.beginFill ( new RGBColor ( 0x009900 ) );
        * myPDF.drawRect ( new Rectangle ( 20, 46, 100, 45 ) );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">drawRect</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">rect</span>:<span class="ActionScriptDefault_Text">Rectangle</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">filled</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">'b'</span> : <span class="ActionScriptString">'S'</span>;
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f %.2f %.2f re %s'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * The drawRoundedRect method draws a rounded rectangle shape
        * @param rect A flash.geom.Rectange object
        * @param ellipseWidth Angle radius
        * @example
        * This example shows how to create a rounded green rectangle in the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.lineStyle ( new RGBColor ( 0x00FF00 ), 1, 0, .3, BlendMode.NORMAL, null, CapsStyle.ROUND, JointStyle.MITER );
        * myPDF.beginFill ( new RGBColor ( 0x009900 ) );
        * myPDF.drawRoundRect ( new Rectangle ( 20, 46, 100, 45 ), 20 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">drawRoundRect</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">rect</span>:<span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ellipseWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hp</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">MyArc</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 4<span class="ActionScriptOperator">/</span>3 <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span>2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f m'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xc</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">ellipseWidth</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">yc</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">ellipseWidth</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f l'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">curve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">ellipseWidth</span> ;
            <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">ellipseWidth</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f l'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">yc</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">curve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">ellipseWidth</span>;
            <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">ellipseWidth</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f l'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">xc</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">curve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">ellipseWidth</span>;
            <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">ellipseWidth</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f l'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">yc</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">curve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">ellipseWidth</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">filled</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">'b'</span> : <span class="ActionScriptString">'S'</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">style</span><span class="ActionScriptBracket/Brace">)</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * The drawComplexRoundRect method draws a rounded rectangle shape
         * 
         * @param rect A flash.geom.Rectange object
         * @param topLeftEllipseWidth Angle radius
         * @param bottomLeftEllipseWidth Angle radius
         * @param topRightEllipseWidth Angle radius
         * @param bottomRightEllipseWidth Angle radius
         * 
         * @example
         * This example shows how to create a complex rounded green rectangle (different angles radius) in the current page :
         * &lt;div class="listing"&gt;
         * &lt;pre&gt;
         *
         * myPDF.lineStyle ( new RGBColor ( 0x00FF00 ), 1, 0, .3, BlendMode.NORMAL, null, CapsStyle.ROUND, JointStyle.MITER );
         * myPDF.beginFill ( new RGBColor ( 0x009900 ) );
         * myPDF.drawComplexRoundRect( new Rectangle ( 5, 5, 40, 40 ), 16, 16, 8, 8 );
         * &lt;/pre&gt;
         * &lt;/div&gt;
         * 
         */</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">drawComplexRoundRect</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">rect</span>:<span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">topLeftEllipseWidth</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">bottomLeftEllipseWidth</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">topRightEllipseWidth</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">bottomRightEllipseWidth</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hp</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">MyArc</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 4<span class="ActionScriptOperator">/</span>3 <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span>2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f m'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">topLeftEllipseWidth</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xc</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">topRightEllipseWidth</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">yc</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">topRightEllipseWidth</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f l'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">curve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">topRightEllipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">topRightEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">topRightEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">topRightEllipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">topRightEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">bottomRightEllipseWidth</span> ;
            <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">bottomRightEllipseWidth</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f l'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">yc</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">curve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">bottomRightEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">bottomRightEllipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">bottomRightEllipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">bottomRightEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">bottomRightEllipseWidth</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">bottomLeftEllipseWidth</span>;
            <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">bottomLeftEllipseWidth</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f l'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">xc</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">curve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bottomLeftEllipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">bottomLeftEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bottomLeftEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">bottomLeftEllipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">bottomLeftEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">topLeftEllipseWidth</span>;
            <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">topLeftEllipseWidth</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f l'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hp</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">yc</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">curve</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">topLeftEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">topLeftEllipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">topLeftEllipseWidth</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">MyArc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">topLeftEllipseWidth</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">xc</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">yc</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">topLeftEllipseWidth</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">filled</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">'b'</span> : <span class="ActionScriptString">'S'</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">style</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * The drawEllipse method draws an ellipse
        * @param x X Position
        * @param y Y Position
        * @param radiusX X Radius
        * @param radiusY Y Radius
        * @example
        * This example shows how to create a rounded red ellipse in the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.lineStyle ( new RGBColor ( 0x990000 ), 1, .3, new DashedLine ([0, 1, 2, 6]), CapsStyle.NONE, JointStyle.ROUND );
        * myPDF.beginFill ( new RGBColor ( 0x990000 ) );
        * myPDF.drawEllipse( 45, 275, 40, 15 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">drawEllipse</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">radiusX</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">radiusY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">filled</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">'b'</span> : <span class="ActionScriptString">'S'</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lx</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 4<span class="ActionScriptOperator">/</span>3<span class="ActionScriptOperator">*</span><span class="ActionScriptBracket/Brace">(</span>1.41421356237309504880<span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">radiusX</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ly</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 4<span class="ActionScriptOperator">/</span>3<span class="ActionScriptOperator">*</span><span class="ActionScriptBracket/Brace">(</span>1.41421356237309504880<span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">radiusY</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">h</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span>;

            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f m %.2f %.2f %.2f %.2f %.2f %.2f c'</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">radiusX</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">radiusX</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">ly</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">lx</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">radiusY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">radiusY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f %.2f %.2f %.2f %.2f c'</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">lx</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">radiusY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">radiusX</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">ly</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">radiusX</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f %.2f %.2f %.2f %.2f c'</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">radiusX</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">ly</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">lx</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">radiusY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">radiusY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f %.2f %.2f %.2f %.2f c %s'</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">lx</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">radiusY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">radiusX</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">ly</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">radiusX</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * The drawCircle method draws a circle
        * @param x X Position
        * @param y Y Position
        * @param radius Circle Radius
        * @example
        * This example shows how to create a rounded red ellipse in the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.beginFill ( new RGBColor ( 0x990000 ) );
        * myPDF.drawCircle ( 30, 180, 20 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">drawCircle</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">radius</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">drawEllipse</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">radius</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">radius</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * The drawPolygone method draws a polygone
        * @param points Array of points
        * @example
        * This example shows how to create a polygone with a few points :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.beginFill ( new RGBColor ( 0x990000 ) );
        * myPDF.drawPolygone ( [89, 40, 20, 90, 40, 50, 10, 60, 70, 90] );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">drawPolygone</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">points</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;

            <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lng</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">moveTo</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">lineTo</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+=</span>2;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">end</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF Interactive API
        *
        * addNote()
        * addTransition()
        * addBookmark()
        * addLink()
        *
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>
        <span class="ActionScriptASDoc">/**
        * Lets you add a text annotation to the current page
        *
        * @param x Note X position
        * @param y Note Y position
        * @param width Note width
        * @param height Note height
        * @param text Text for the note
        * @example
        * This example shows how to add a note annotation in the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.addNote (100, 75, 50, 50, "A note !");
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addTextNote</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"A note !"</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rectangle</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span>;

            <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">annotations</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">'&lt;&lt;/Type /Annot /Name /Help /Border [0 0 1] /Subtype /Text /Rect [ '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rectangle</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' ] /Contents ('</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">')&gt;&gt;'</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
        * Lets you add a stamp annotation to the current page
        *
        * @param style Stamp style can be StampStyle.CONFIDENTIAL, StampStyle.FOR_PUBLIC_RELEASE, etc.
        * @param x Note X position
        * @param y Note Y position
        * @param width Note width
        * @param height Note height
        * @example
        * This example shows how to add a stamp annotation in the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.addStampNote ( StampStyle.CONFIDENTIAL, 15, 15, 50, 50 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addStampNote</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rectangle</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span>;
            
            <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">annotations</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">'&lt;&lt;/Type /Annot /Name /'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' /Subtype /Stamp /Rect [ '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rectangle</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' ]&gt;&gt;'</span> <span class="ActionScriptBracket/Brace">)</span>;    
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you add a bookmark
        *
        * @param text Text appearing in the outline panel
        * @param level Specify the bookmark's level
        * @param y Position in the current page to go
        * @param red Red offset for the text color
        * @param green Green offset for the text color
        * @param blue Blue offset for the text color
        * @example
        * This example shows how to add a bookmark for the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.addBookmark("A bookmark", 0, 0, 0, .9, 0);
        * myPDF.addPage();
        * myPDF.addBookmark("Another bookmark", 0, 60, .9, .9, 0);
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addBookmark</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">level</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">RGBColor</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptString">'t'</span> : <span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">'Page '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">nbPages</span> : <span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">'l'</span> : <span class="ActionScriptDefault_Text">level</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">'y'</span> : <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">'p'</span> : <span class="ActionScriptDefault_Text">nbPages</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">redMultiplier</span> : <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">greenMultiplier</span> : <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">g</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blueMultiplier</span> : <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
        * Lets you add clickable link to a specific position
        *
        * @param x Page Format, can be Size.A3, Size.A4, Size.A5, Size.LETTER or Size.LEGAL
        * @param y
        * @param width
        * @param height
        * @param link
        * @param highlight
        * @example
        * This example shows how to add an invisible clickable link in the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.addLink ( 70, 4, 60, 16, "http://www.alivepdf.org");
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addLink</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">link</span>:<span class="ActionScriptOperator">*</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">highlight</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"I"</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rectangle</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span>;

            <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">annotations</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">"&lt;&lt;/Type /Annot /Subtype /Link /Rect ["</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">rectangle</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"] /Border [0 0 0] /H /"</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">highlight</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">" "</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">link</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">annotations</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">"/A &lt;&lt;/S /URI /URI "</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">link</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"&gt;&gt;&gt;&gt;"</span>;

            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">links</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">link</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">h</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">orientationChanges</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">wPt</span> : <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hPt</span>;
                <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">annotations</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Dest [%d 0 R /XYZ 0 %.2f null]&gt;&gt;'</span><span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">+</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you add a transition between each PDF page
        * Note : PDF must be shown in fullscreen to see the transitions, use the setDisplayMode method with the PageMode.FULL_SCREEN parameter
        * 
        * @param style Transition style, can be Transition.SPLIT, Transition.BLINDS, BLINDS.BOX, Transition.WIPE, etc.
        * @param duration The transition duration
        * @param dimension The dimension in which the the specified transition effect occurs
        * @param motionDirection The motion's direction for the specified transition effect
        * @param transitionDirection The direction in which the specified transition effect moves
        * @example
        * This example shows how to add a 4 seconds "Wipe" transition between the first and second page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt; 
        * myPDF.addPage();  
        * myPDF.addTransition (Transition.WIPE, 4, Dimension.VERTICAL);
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addTransition</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'R'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">duration</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">dimension</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'H'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">motionDirection</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'I'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">transitionDirection</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0 <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addTransition</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">duration</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">dimension</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">motionDirection</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">transitionDirection</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you control the way the document is to be presented on the screen or in print.
        *
        * @param toolbar Toolbar behavior
        * @param menubar Menubar behavior
        * @param windowUI WindowUI behavior
        * @param fitWindow Specify whether to resize the document's window to fit the size of the first displayed page.
        * @param centeredWindow Specify whether to position the document's window in the center of the screen.
        * @param displayTitle Specify whether the window's title bar should display the document title taken from the value passed to the setTitle method
        * @example
        * This example shows how to present the document centered on the screen with no toolbars :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setViewerPreferences (ToolBar.HIDE, MenuBar.HIDE, WindowUI.HIDE, FitWindow.DEFAULT, CenterWindow.CENTERED);
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setViewerPreferences</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">toolbar</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'false'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">menubar</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'false'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">windowUI</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'false'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fitWindow</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'false'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">centeredWindow</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'false'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">displayTitle</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'false'</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">viewerPreferences</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'/ViewerPreferences &lt;&lt; /HideToolbar '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">toolbar</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' /HideMenubar '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">menubar</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' /HideWindowUI '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">windowUI</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' /FitWindow '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">fitWindow</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' /CenterWindow '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">centeredWindow</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' /DisplayDocTitle '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">displayTitle</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' &gt;&gt;'</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF font API
        *
        * setFont()
        * setFontSize()
        *
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>
        <span class="ActionScriptASDoc">/**
        * Lets you set a specific font
        *
        * @param amily Font family, can be any of FontFamily.COURIER, FontFamily.HELVETICA, FontFamily.ARIAL, FontFamily.TIMES, FontFamily.SYMBOL, FontFamily.ZAPFDINGBATS.
        * @param style Any font style, can be Style.BOLD, Style.ITALIC, Style.BOLD_ITALIC, Style.NORMAL
        * @example
        * This example shows how to set the Helvetica font, with a bold style :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setFont( FontFamily.HELVETICA, Style.BOLD );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setFont</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">family</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">size</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0 <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fontFamily</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">FontFamily</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ARIAL</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'helvetica'</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">FontFamily</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SYMBOL</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">FontFamily</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ZAPFDINGBATS</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span>;
            <span class="ActionScriptDefault_Text">style</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toUpperCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">family</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toLowerCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Style</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UNDERLINE</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">underline</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">style</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findAndReplace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Style</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UNDERLINE</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">underline</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">size</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">size</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fontSizePt</span>;
            
            <span class="ActionScriptDefault_Text">fontkey</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">family</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">style</span>;
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fonts</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">fontkey</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">standardFonts</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">fontkey</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FontMetrics</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">fontkey</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">file</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">family</span>;
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">FontFamily</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TIMES</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">family</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">FontFamily</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">HELVETICA</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">file</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toLowerCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">FontMetrics</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">fontkey</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'Could not include font metric file'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getNumImages</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fonts</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span>1;
                    <span class="ActionScriptDefault_Text">fonts</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">fontkey</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptDefault_Text">i</span> : <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">type</span> : <span class="ActionScriptDefault_Text">FontType</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CORE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">name</span> : <span class="ActionScriptDefault_Text">standardFonts</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">fontkey</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">up</span> : <span class="ActionScriptOperator">-</span>100<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ut</span> : 50<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cw</span> : <span class="ActionScriptDefault_Text">FontMetrics</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">fontkey</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">}</span>;

                <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'Undefined font: '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">family</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">style</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">fontFamily</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">family</span>;
            <span class="ActionScriptDefault_Text">fontStyle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">style</span>;
            <span class="ActionScriptDefault_Text">fontSizePt</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">size</span>;
            <span class="ActionScriptDefault_Text">fontSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">size</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptDefault_Text">currentFont</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fonts</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">fontkey</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">nbPages</span><span class="ActionScriptOperator">&gt;</span>0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'BT /F%d %.2f Tf ET'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fontSizePt</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you set a new size for the current font
        *
        * @param size Font size
        * @example
        * This example shows how to se the current font to 18 :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setFontSize( 18 );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setFontSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">size</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fontSizePt</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">size</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptDefault_Text">fontSizePt</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">size</span>;
            <span class="ActionScriptDefault_Text">fontSize</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">size</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nbPages</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'BT /F%d %.2f Tf ET'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">fontSizePt</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF transform API
        *
        * skew()
        * rotate()
        *
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">skew</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ax</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ay</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>-1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>-1<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ax</span> <span class="ActionScriptOperator">==</span> 90 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">ay</span> <span class="ActionScriptOperator">==</span> 90<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RangeError</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Please use values between -90 and 90 for skewing."</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptDefault_Text">ax</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PI</span> <span class="ActionScriptOperator">/</span> 180;
            <span class="ActionScriptDefault_Text">ay</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PI</span> <span class="ActionScriptOperator">/</span> 180;
            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">identity</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">a</span> <span class="ActionScriptOperator">=</span> 1;
            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tan</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ay</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tan</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ax</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">d</span> <span class="ActionScriptOperator">=</span> 1;
            <span class="ActionScriptDefault_Text">getMatrixTransformPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">rotate</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">angle</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>-1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>-1<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptDefault_Text">angle</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PI</span> <span class="ActionScriptOperator">/</span> 180;
            <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">identity</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rotate</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">angle</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">getMatrixTransformPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tm</span>:<span class="ActionScriptDefault_Text">Matrix</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.3f %.3f %.3f %.3f %.3f %.3f cm'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">a</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">d</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ty</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getMatrixTransformPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">px</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">py</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">position</span>:<span class="ActionScriptDefault_Text">Point</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">px</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">py</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">deltaPoint</span>:<span class="ActionScriptDefault_Text">Point</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">deltaTransformPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tx</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">px</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">deltaPoint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ty</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">py</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">deltaPoint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">startTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'q'</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">stopTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'Q'</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF text API
        *
        * addText()
        * textStyle()
        * addCell()
        * addMultiCell()
        * writeText()
        *
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>
        <span class="ActionScriptASDoc">/**
        * Lets you set some text to any position on the page
        *
        * @param text The text to add
        * @param x X position
        * @param y Y position
        * @example
        * This example shows how to set some text to a specific place :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.addText ('Cubic Bezier curve with curveTo', 14, 110);
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addText</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0 <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'BT %.2f %.2f Td (%s) Tj ET'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">escape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">underline</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">!=</span><span class="ActionScriptString">''</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">doUnderline</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">colorFlag</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'q '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+</span><span class="ActionScriptString">' Q'</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addVerticalText</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'BT %.2f %.2f %.2f %.2f %.2f %.2f Tm (%s) Tj ET'</span><span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> 1<span class="ActionScriptOperator">,</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">escape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">underline</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">!=</span><span class="ActionScriptString">''</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">doUnderline</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">colorFlag</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'q '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+</span><span class="ActionScriptString">' Q'</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Sets the text style
        *
        * @param color Color object, can be CMYKColor, GrayColor, or RGBColor
        * @param alpha Text opacity
        * @param rendering pRendering Specify the text rendering mode
        * @param wordSpace Spaces between each words
        * @param characterSpace Spaces between each characters
        * @param scale Text scaling
        * @param leading Text leading
        * @example
        * This example shows how to set a specific black text style with full opacity :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.textStyle ( new RGBColor ( 0x000000 ), 1 ); 
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">textStyle</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">Color</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">alpha</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rendering</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">wordSpace</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">characterSpace</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">scale</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>100<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">leading</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0 <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">sprintf</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">'%d Tr'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textRendering</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rendering</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">textColor</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">setAlpha</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">alpha</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">wordSpace</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' Tw '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">characterSpace</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' Tc '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">scale</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' Tz '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">leading</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">' TL '</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">colorFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">fillColor</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Add a cell with some text to the current page
        *
        * @param width Cell width
        * @param height Cell height
        * @param text Text to add into the cell
        * @param ln Sets the new position after cell is drawn, default value is 0
        * @param align Lets you center or align the text into the cell
        * @param fill Lets you specify if the cell is colored (1) or transparent (0)
        * @param link Any http link, like http://www.mylink.com
        * @return Page
        * @example
        * This example shows how to write some text within a cell :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setFont(FontFamily.HELVETICA, 'B', 12);
        * myPDF.textStyle ( new RGBColor ( 0x990000 ) );
        * myPDF.addCell(50,10,'Some text into a cell !',1,1);
        * &lt;/pre&gt;
        * &lt;/div&gt;
        * This example shows how to write some clikable text within a cell :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setFont(FontFamily.HELVETICA, 'B', 12);
        * myPDF.textStyle ( new RGBColor ( 0x990000 ) );
        * myPDF.addCell(50,10,'A clikable cell !', 1, 1, null, 0, "http://www.alivepdf.org");
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addCell</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">border</span>:<span class="ActionScriptOperator">*</span>=<span class="ActionScriptOperator">0</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">ln</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">align</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fill</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">link</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//Output a cell
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">pageBreakTrigger</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">inHeader</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">inFooter</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">acceptPageBreak</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//Automatic page break
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentX</span>;
                <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ws</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">=</span>0;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0 Tw'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">addPage</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Page</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">currentOrientation</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultUnit</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultSize</span> <span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rotation</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">x</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ws</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.3f Tw'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">==</span>0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentX</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">op</span>:<span class="ActionScriptDefault_Text">String</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">fill</span> <span class="ActionScriptOperator">==</span> 1 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">border</span> <span class="ActionScriptOperator">==</span> 1 <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">fill</span> <span class="ActionScriptOperator">==</span> 1 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">border</span> <span class="ActionScriptOperator">==</span> 1 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">'B'</span> : <span class="ActionScriptString">'f'</span>;
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">op</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'S'</span>;
                
                <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f %.2f %.2f re %s '</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">op</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">border</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentX</span>;
                <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentY</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tmpBorder</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">border</span> <span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">tmpBorder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'L'</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f m %.2f %.2f l S '</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">tmpBorder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'T'</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f m %.2f %.2f l S '</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">tmpBorder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'R'</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f m %.2f %.2f l S '</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">tmpBorder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'B'</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f m %.2f %.2f l S '</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">!==</span> <span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dx</span>:<span class="ActionScriptDefault_Text">Number</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">align</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">Align</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RIGHT</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">dx</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">getStringWidth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">align</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">Align</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CENTER</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">dx</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">getStringWidth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">/</span>2;
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">dx</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cMargin</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">colorFlag</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptString">'q '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">addTextColor</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">txt2</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findAndReplace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">')'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">'\\)'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">findAndReplace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'('</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">'\\('</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">findAndReplace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'\\'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">'\\\\'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'BT %.2f %.2f Td (%s) Tj ET'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">dx</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptOperator">+</span>.5<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">+</span>.3<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">txt2</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">underline</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">doUnderline</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">dx</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptOperator">+</span>.5<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">+</span>.3<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">colorFlag</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptString">' Q'</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">link</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">addLink</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">dx</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">currentY</span><span class="ActionScriptOperator">+</span>.5<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">-</span>.5<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">getStringWidth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">fontSize</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">link</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">lasth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">ln</span> <span class="ActionScriptOperator">&gt;</span>0 <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//Go to next line
</span>                <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">height</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">ln</span> <span class="ActionScriptOperator">==</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;

            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">width</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Add a multicell with some text to the current page
        *
        * @param width Cell width
        * @param height Cell height
        * @param text Text to add into the cell
        * @param border Lets you specify if a border should be drawn around the cell
        * @param align Lets you center or align the text into the cell, values can be L (left align), C (centered), R (right align), J (justified) default value
        * @param filled Lets you specify if the cell is colored (1) or transparent (0)
        * @return Page
        * @example
        * This example shows how to write a table made of text cells :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setFont( FontFamily.COURIER, Style.BOLD, 14 );
        * myPDF.textStyle ( new RGBColor ( 0x990000 ) );
        * myPDF.addMultiCell ( 70, 24, "A multicell :)", 1);
        * myPDF.addMultiCell ( 70, 24, "A multicell :)", 1);
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addMultiCell</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">border</span>:<span class="ActionScriptOperator">*</span>=<span class="ActionScriptOperator">0</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">align</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'J'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">filled</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">cw</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cw</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">==</span>0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">currentX</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">wmax</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">-</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>1000<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">fontSize</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findAndReplace</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\r"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nb</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">nb</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">charAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"\n"</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptOperator">--</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptOperator">*</span> <span class="ActionScriptOperator">=</span> 0;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">border</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">border</span> <span class="ActionScriptOperator">==</span> 1 <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">border</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'LTRB'</span>;
                    <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'LRT'</span>;
                    <span class="ActionScriptDefault_Text">b2</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'LR'</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">b2</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">border</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'L'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">b2</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptString">'L'</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">border</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'R'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">b2</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptString">'R'</span>;
                    <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">border</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'T'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">b2</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'T'</span> : <span class="ActionScriptDefault_Text">b2</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sep</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> -1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ns</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nl</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">String</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cwAux</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;

            <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                 <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">charAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>;
                 
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">==</span><span class="ActionScriptString">"\n"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">=</span>0;
                        <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0 Tw'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">addCell</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">align</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">filled</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span>-1;
                    <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">=</span>0;
                    <span class="ActionScriptDefault_Text">ns</span><span class="ActionScriptOperator">=</span>0;
                    <span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">++</span>;
                    
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">border</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">==</span>2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">b2</span>;
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">==</span><span class="ActionScriptString">' '</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ls</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">l</span>;
                    <span class="ActionScriptDefault_Text">ns</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// TBO
</span>                <span class="ActionScriptDefault_Text">cwAux</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cw</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">int</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cwAux</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">cwAux</span> <span class="ActionScriptOperator">=</span> 580;
                <span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">cwAux</span>;

                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">&gt;</span><span class="ActionScriptDefault_Text">wmax</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">==</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">=</span>0;
                            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0 Tw'</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptDefault_Text">addCell</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">align</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">filled</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">align</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">Align</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">JUSTIFIED</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ns</span><span class="ActionScriptOperator">&gt;</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wmax</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">ls</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">/</span>1000<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span><span class="ActionScriptOperator">/</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ns</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span> : 0;
                            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.3f Tw'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        
                        <span class="ActionScriptDefault_Text">addCell</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">align</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">filled</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">+</span>1;
                        
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span>-1;
                    <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">=</span>0;
                    <span class="ActionScriptDefault_Text">ns</span><span class="ActionScriptOperator">=</span>0;
                    <span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">border</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">nl</span> <span class="ActionScriptOperator">==</span> 2 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b2</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptComment">//Last chunk
</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">=</span>0;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0 Tw'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">border</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">border</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'B'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">'B'</span>;
            <span class="ActionScriptDefault_Text">addCell</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">align</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">filled</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
        * Lets you write some text
        *
        * @param lineHeight Line height, lets you specify height between each lines
        * @param text Text to write, to put a line break just add a \n in the text string
        * @param link Any link, like http://www.mylink.com, will open te browser when clicked
        * @example
        * This example shows how to add some text to the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.writeText ( 5, "Lorem ipsum dolor sit amet, consectetuer adipiscing elit.", "http://www.google.fr");
        * &lt;/pre&gt;
        * &lt;/div&gt;
        * This example shows how to add some text with a clickable link :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.writeText ( 5, "Lorem ipsum dolor sit amet, consectetuer adipiscing elit.", "http://www.google.fr");
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeText</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">lineHeight</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">link</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//Output text in flowing mode
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cw</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cw</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentX</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">wmax</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>1000<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">fontSize</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findAndReplace</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\r"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//var s:String = ",,,"
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nb</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sep</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> -1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nl</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">String</span>;

            <span class="ActionScriptReserved">while</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">nb</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//Get next character
</span>                <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">charAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"\n"</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">//Explicit line break
</span>                    <span class="ActionScriptDefault_Text">addCell</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">lineHeight</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">link</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span>-1;
                    <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">=</span>0;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">==</span>1<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
                        <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentX</span>;
                        <span class="ActionScriptDefault_Text">wmax</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>1000<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">fontSize</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">==</span><span class="ActionScriptString">' '</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">cw</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">wmax</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">//Automatic line break
</span>                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">==</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">&gt;</span><span class="ActionScriptDefault_Text">lMargin</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptComment">//Move to next line
</span>                            <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
                            <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span>;
                            <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentX</span>;
                            <span class="ActionScriptDefault_Text">wmax</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>1000<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">fontSize</span>;
                            <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                            <span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">++</span>;
                            <span class="ActionScriptReserved">continue</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                        <span class="ActionScriptDefault_Text">addCell</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">lineHeight</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">link</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">addCell</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">lineHeight</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>2<span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">link</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">+</span>1;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span>-1;
                    <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">=</span>0;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">==</span>1<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">lMargin</span>;
                        <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentX</span>;
                        <span class="ActionScriptDefault_Text">wmax</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>1000<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">fontSize</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptComment">//Last chunk
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">!=</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptDefault_Text">addCell</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">/</span>1000<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">lineHeight</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">link</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
        * Lets you write some text with basic HTML type formatting
        *
        * @param pHeight Line height, lets you specify height between each lines
        * @param pText Text to write, to put a line break just add a \n in the text string
        * @param pLink Any link, like http://www.mylink.com, will open te browser when clicked
        * @example
        * 
        * Only a limited subset of tags are currently supported
        *  &lt;b&gt; &lt;/b&gt;
        *  &lt;i&gt; &lt;/i&gt;
        *  &lt;font&gt; &lt;/font&gt;
        *  &lt;u&gt; &lt;/u&gt;
        *  &lt;br /&gt;  used to create a new line
        * 
        * This example shows how to add some basic HTML text to the current page :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.writeFlashHtmlText( 5, "Lorem ipsum dolor &lt;b&gt;sit amet&lt;/b&gt;, consectetur &lt;font color='#990000'&gt;adipiscing elit&lt;/font&gt;. Sed eget orci. &lt;i&gt;Fusce luctus feugiat tortor&lt;/i&gt;.");
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeFlashHtmlText</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">pHeight</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">pText</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">pLink</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//Output text in flowing mode
</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cw</span>    : <span class="ActionScriptDefault_Text">Object</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cw</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span>     : <span class="ActionScriptDefault_Text">Number</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentX</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">wmax</span>  : <span class="ActionScriptDefault_Text">Number</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>1000<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">fontSize</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>     : <span class="ActionScriptDefault_Text">String</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findAndReplace</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\r"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">pText</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">// Strip all \n's as we don't use them - use &lt;br /&gt; tag for returns
</span>            <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findAndReplace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\n"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nb</span>      : <span class="ActionScriptDefault_Text">int</span>;        <span class="ActionScriptComment">// Count of number of characters in section
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sep</span>     : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> -1;   <span class="ActionScriptComment">// Stores the position of the last seperator
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lenAtSep</span>: <span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptComment">// Store the length at the last seprator 
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>       : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;    <span class="ActionScriptComment">// Counter for looping through each string
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>       : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;    <span class="ActionScriptComment">// Counter which is updated with character count to be actually output (taking auto line breaking into account)
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l</span>       : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;    <span class="ActionScriptComment">// Length of the the current character string
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>       : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;    <span class="ActionScriptComment">// Counter for looping through each item in the parsed XML array  
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ns</span>      : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptComment">//XML whitespace is important for this text parsing - so save prev value so we can restore it.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">prevWhiteSpace</span>    : <span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">XML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ignoreWhitespace</span>;
            <span class="ActionScriptDefault_Text">XML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ignoreWhitespace</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">aTaggedString</span>     : <span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseTags</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">XML</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">"&lt;HTML&gt;"</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"&lt;/HTML&gt;"</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                        
            <span class="ActionScriptDefault_Text">XML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ignoreWhitespace</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">prevWhiteSpace</span>;
            
            <span class="ActionScriptComment">//Stores the cell snippets for the current line
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentLine</span>      : <span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; 
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cellVO</span>           : <span class="ActionScriptDefault_Text">CellVO</span>;
            
            <span class="ActionScriptComment">//Variables to track the state of the current text
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontBold</span>         : <span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>; 
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontItalic</span>       : <span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontUnderline</span>    : <span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textAlign</span>        : <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">''</span>; 
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">attr</span>             : <span class="ActionScriptDefault_Text">XML</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cwAux</span>            : <span class="ActionScriptDefault_Text">int</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fs</span>               : <span class="ActionScriptDefault_Text">int</span>;      <span class="ActionScriptComment">// Font size
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fc</span>               : <span class="ActionScriptDefault_Text">RGBColor</span>; <span class="ActionScriptComment">// font color;
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cs</span>               : <span class="ActionScriptDefault_Text">int</span>;      <span class="ActionScriptComment">// character space ( not implemented yet )
</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">aTaggedString</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;

            <span class="ActionScriptComment">//Loop through each item in array
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lng</span>; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>            
                <span class="ActionScriptComment">//Handle any tags and if unknown then handle as text    
</span>                <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">aTaggedString</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tag</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>    
                    <span class="ActionScriptComment">//Process Tags
</span>                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;TEXTFORMAT&gt;"</span>:
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;/TEXTFORMAT&gt;"</span>:
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;P&gt;"</span>:

                        <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">attr</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">aTaggedString</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attr</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>

                            <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">attr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toUpperCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>

                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"ALIGN"</span>: 
                                     <span class="ActionScriptDefault_Text">textAlign</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">attr</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">charAt</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>;
                                     <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">default</span>:
                                    <span class="ActionScriptComment">// TODO: are there more attributes!!?!?!
</span>                                    <span class="ActionScriptReserved">break</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;/P&gt;"</span>:
                        <span class="ActionScriptDefault_Text">renderLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">textAlign</span><span class="ActionScriptBracket/Brace">)</span>;
                        
                        <span class="ActionScriptDefault_Text">currentLine</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">currentX</span>   <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
                        <span class="ActionScriptDefault_Text">textAlign</span>       <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">''</span>;
                        <span class="ActionScriptDefault_Text">ns</span>              <span class="ActionScriptOperator">=</span> 0;
                        
                        <span class="ActionScriptDefault_Text">lineBreak</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">pHeight</span> <span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;FONT&gt;"</span>:
                        <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">attr</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">aTaggedString</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attr</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>

                            <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">attr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toUpperCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>

                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"FACE"</span>:
                                    <span class="ActionScriptComment">// TODO: Add Font Face Support
</span>                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"SIZE"</span>:
                                    <span class="ActionScriptDefault_Text">fs</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseInt</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">attr</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"COLOR"</span>:
                                    <span class="ActionScriptDefault_Text">fc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">RGBColor</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hexStringToRGBColor</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">attr</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"LETTERSPACING"</span>:
                                    <span class="ActionScriptDefault_Text">cs</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseInt</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">attr</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"KERNING"</span>:
                                    <span class="ActionScriptComment">// TODO
</span>                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">default</span>:
                                    <span class="ActionScriptReserved">break</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;/FONT&gt;"</span>:
                        <span class="ActionScriptDefault_Text">fc</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RGBColor</span> <span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;A&gt;"</span>:
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;/A&gt;"</span>:
                        <span class="ActionScriptComment">// TODO: link support
</span>                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;IMG&gt;"</span>:
                        <span class="ActionScriptComment">// TODO: Implement image support
</span>                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;B&gt;"</span>:
                        <span class="ActionScriptDefault_Text">fontBold</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;/B&gt;"</span>:
                        <span class="ActionScriptDefault_Text">fontBold</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;I&gt;"</span>:
                        <span class="ActionScriptDefault_Text">fontItalic</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;/I&gt;"</span>:
                        <span class="ActionScriptDefault_Text">fontItalic</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;U&gt;"</span>:
                        <span class="ActionScriptDefault_Text">fontUnderline</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;/U&gt;"</span>:
                        <span class="ActionScriptDefault_Text">fontUnderline</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;BR&gt;"</span>:
                        <span class="ActionScriptComment">// Both cases will set line break to true.  It is typically entered as &lt;br /&gt; 
</span>                        <span class="ActionScriptComment">// but the parser converts this to a start and end tag
</span>                        <span class="ActionScriptDefault_Text">lineBreak</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">pHeight</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"&lt;/BR&gt;"</span>:
                    <span class="ActionScriptReserved">default</span>:
                        <span class="ActionScriptComment">//Process text                    
</span>                    
                        <span class="ActionScriptComment">//Create a blank CellVO for this part
</span>                        <span class="ActionScriptDefault_Text">cellVO</span>            <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">CellVO</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontStyle</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getFontStyleString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fontBold</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">fontItalic</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">fontUnderline</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontFamily</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fontFamily</span>;

                        <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontSizePt</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fs</span>;
                        <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">color</span>          <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fc</span>;
                        <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">characterSpace</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cs</span>;  <span class="ActionScriptComment">// this is only stored, this isn't implemented
</span>                        
                        <span class="ActionScriptComment">//Set the font for calculation of character widths
</span>
                        <span class="ActionScriptComment">//TODO: Change this to not call setFont but to get currentFont.cw 
</span>                        <span class="ActionScriptComment">// directly ro prevent mutliple font lines being output to PDF
</span>                        <span class="ActionScriptDefault_Text">setFont</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontFamily</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontStyle</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontSizePt</span> <span class="ActionScriptBracket/Brace">)</span>;
                                    
                        <span class="ActionScriptComment">//Font character width lookup table
</span>                        <span class="ActionScriptDefault_Text">cw</span>      <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cw</span>; 
                        
                        <span class="ActionScriptComment">//Current remaining space per line
</span>                        <span class="ActionScriptDefault_Text">w</span>       <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentX</span>;
                        
                        <span class="ActionScriptComment">//Size of a full line of text
</span>                        <span class="ActionScriptDefault_Text">wmax</span>    <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>1000<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">fontSize</span>;  
                        
                        <span class="ActionScriptComment">//get text from string
</span>                        <span class="ActionScriptDefault_Text">s</span>   <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">aTaggedString</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">value</span>; 
                        
                        <span class="ActionScriptComment">//Length of string
</span>                        <span class="ActionScriptDefault_Text">nb</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
                          
                        <span class="ActionScriptDefault_Text">i</span>   <span class="ActionScriptOperator">=</span>  0;
                        <span class="ActionScriptDefault_Text">j</span>   <span class="ActionScriptOperator">=</span>  0;
                        <span class="ActionScriptDefault_Text">sep</span> <span class="ActionScriptOperator">=</span> -1;
                        <span class="ActionScriptDefault_Text">l</span>   <span class="ActionScriptOperator">=</span>  0;

                        <span class="ActionScriptReserved">while</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">nb</span> <span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptComment">//Get next character
</span>                            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span> : <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">charAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>;
                
                            <span class="ActionScriptComment">//Found a seperator
</span>                            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">' '</span> <span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span> 
                                <span class="ActionScriptDefault_Text">sep</span>      <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span>;    <span class="ActionScriptComment">//Save seperator index
</span>                                <span class="ActionScriptDefault_Text">lenAtSep</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">l</span>;    <span class="ActionScriptComment">//Save seperator length
</span>                                <span class="ActionScriptDefault_Text">ns</span><span class="ActionScriptOperator">++</span>;
                            <span class="ActionScriptBracket/Brace">}</span>

                            <span class="ActionScriptComment">//Add the character width to the length;
</span>                            <span class="ActionScriptDefault_Text">cwAux</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cw</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">int</span>;
                            
                            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cwAux</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptBracket/Brace">)</span> 
                                <span class="ActionScriptDefault_Text">cwAux</span> <span class="ActionScriptOperator">=</span> 580;

                            <span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">cwAux</span>;
                            
                            <span class="ActionScriptComment">//Are we Over the char width limit?
</span>                            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">wmax</span> <span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptComment">//Automatic line break
</span>                                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">sep</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptBracket/Brace">)</span>
                                <span class="ActionScriptBracket/Brace">{</span>
                                     <span class="ActionScriptComment">// No seperator to force at character
</span>                                     
                                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentX</span><span class="ActionScriptOperator">&gt;</span><span class="ActionScriptDefault_Text">lMargin</span><span class="ActionScriptBracket/Brace">)</span>
                                    <span class="ActionScriptBracket/Brace">{</span>
                                        <span class="ActionScriptComment">//Move to next line
</span>                                        <span class="ActionScriptDefault_Text">currentX</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
                                        <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">pHeight</span>;

                                        <span class="ActionScriptDefault_Text">w</span>    <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">currentX</span>;
                                        <span class="ActionScriptDefault_Text">wmax</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>1000<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">fontSize</span>;

                                        <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                                        <span class="ActionScriptReserved">continue</span>;
                                    <span class="ActionScriptBracket/Brace">}</span>
                                    
                                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptBracket/Brace">)</span> 
                                        <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                                    
                                    <span class="ActionScriptComment">//Set the lenght to the size before it was greater than wmax
</span>                                    <span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">cwAux</span>;
                                    
                                    <span class="ActionScriptComment">//Add the cell to the current line
</span>                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentX</span>;
                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentY</span>;
                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">/</span>1000<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span>;
                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pHeight</span>;
                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span>;
                                    
                                    <span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cellVO</span> <span class="ActionScriptBracket/Brace">)</span>;
                        
                                    <span class="ActionScriptComment">//Just done a line break so render the line
</span>                                    <span class="ActionScriptDefault_Text">renderLine</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textAlign</span> <span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">currentLine</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                        
                                    <span class="ActionScriptComment">//Update x and y positions            
</span>                                    <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
                                    
                                <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span>
                                <span class="ActionScriptBracket/Brace">{</span>
                                    
                                    <span class="ActionScriptComment">//Split at last seperator
</span>                                    
                                    <span class="ActionScriptComment">//Add the cell to the current line
</span>                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>      <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentX</span>;
                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>      <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentY</span>;
                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lenAtSep</span><span class="ActionScriptOperator">/</span>1000<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span>;
                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pHeight</span>;
                                    <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span>   <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptBracket/Brace">)</span>;

                                    <span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cellVO</span> <span class="ActionScriptBracket/Brace">)</span>;
                                    
                                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">textAlign</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Align</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">JUSTIFIED</span> <span class="ActionScriptBracket/Brace">)</span>
                                    <span class="ActionScriptBracket/Brace">{</span>
                                        <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ns</span><span class="ActionScriptOperator">&gt;</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wmax</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">lenAtSep</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">/</span>1000<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span><span class="ActionScriptOperator">/</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ns</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span> : 0;
                                        <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.3f Tw'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptBracket/Brace">}</span>

                                    <span class="ActionScriptComment">//Just done a line break so render the line
</span>                                    <span class="ActionScriptDefault_Text">renderLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">textAlign</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">currentLine</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                                    
                                    <span class="ActionScriptComment">//Update x and y positions            
</span>                                    <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
                                
                                    <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">-</span> 2 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">cMargin</span>;
                                    <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sep</span> <span class="ActionScriptOperator">+</span> 1;
                                <span class="ActionScriptBracket/Brace">}</span>
                                
                                <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span> -1;
                                <span class="ActionScriptDefault_Text">j</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span>;
                                <span class="ActionScriptDefault_Text">l</span>  <span class="ActionScriptOperator">=</span> 0;
                                <span class="ActionScriptDefault_Text">ns</span> <span class="ActionScriptOperator">=</span> 0;
                                
                                <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
                                
                                <span class="ActionScriptDefault_Text">w</span>   <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">rMargin</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">currentX</span>;
                                <span class="ActionScriptDefault_Text">wmax</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span>2 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">cMargin</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> 1000 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">fontSize</span>;
                                
                            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        
                        <span class="ActionScriptComment">//Last chunk 
</span>                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                             <span class="ActionScriptComment">//If any remaining chars then print them out                            
</span>                            <span class="ActionScriptComment">//Add the cell to the current line
</span>                            
                            <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentX</span>;
                            <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentY</span>;
                            <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">/</span>1000<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span>;
                            <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pHeight</span>;
                            <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span>;
                            
                            <span class="ActionScriptComment">//Last chunk
</span>                            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">&gt;</span>0 <span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">=</span>0;
                                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0 Tw'</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span>                
                            
                            <span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cellVO</span> <span class="ActionScriptBracket/Brace">)</span>;

                            <span class="ActionScriptComment">//Update X positions
</span>                            <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>;
                            
                        <span class="ActionScriptBracket/Brace">}</span> 
                        <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptBracket/Brace">}</span>        

                <span class="ActionScriptComment">//Is there a finished line     
</span>                <span class="ActionScriptComment">// or last line and there is something to display
</span>                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">aTaggedString</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>    
                    <span class="ActionScriptDefault_Text">renderLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">textAlign</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptDefault_Text">lineBreak</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pHeight</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptDefault_Text">currentLine</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">//Is there anything left to render before we exit?
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>    
                <span class="ActionScriptDefault_Text">renderLine</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">currentLine</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">textAlign</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">lineBreak</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">pHeight</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">currentLine</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>            

            <span class="ActionScriptComment">//Set current y off the page to force new page.
</span>            <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span>;    
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">lineBreak</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">pHeight</span> : <span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptDefault_Text">currentX</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lMargin</span>;
            <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">pHeight</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getFontStyleString</span> <span class="ActionScriptBracket/Brace">(</span>  <span class="ActionScriptDefault_Text">bold</span> : <span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">italic</span> : <span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">underline</span> : <span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fontStyle</span>:<span class="ActionScriptDefault_Text">String</span>  <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
                        
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">bold</span> <span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptDefault_Text">fontStyle</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">"B"</span>;
                
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">italic</span> <span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptDefault_Text">fontStyle</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">"I"</span>;
                
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">underline</span> <span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptDefault_Text">fontStyle</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">"U"</span>;
                
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">fontStyle</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">renderLine</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">lineArray</span> : <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">align</span> : <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cellVO</span>    : <span class="ActionScriptDefault_Text">CellVO</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">availWidth</span>: <span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">lMargin</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">rMargin</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lineLength</span>: <span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">offsetX</span>   : <span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0; 
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">offsetY</span>   : <span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0; 
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>         : <span class="ActionScriptDefault_Text">int</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">firstCell</span> : <span class="ActionScriptDefault_Text">CellVO</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">CellVO</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lineArray</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">firstCell</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span>;
                
            <span class="ActionScriptComment">//Check if we need a new page for this line
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">firstCell</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">firstCell</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">pageBreakTrigger</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>    
                <span class="ActionScriptDefault_Text">addPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Page</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">defaultOrientation</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultUnit</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultSize</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">defaultRotation</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptComment">//Use offsetY to push already specified coord for this line back up to top of page
</span>                <span class="ActionScriptDefault_Text">offsetY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">firstCell</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span>;                                
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lineArray</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;

            <span class="ActionScriptComment">//Calculate offset if we are aligning center or right
</span>            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lng</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">lineLength</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lineArray</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CellVO</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>;
                
            <span class="ActionScriptComment">//Adjust offset based on alignment
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">align</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Align</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CENTER</span> <span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptDefault_Text">offsetX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">availWidth</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">lineLength</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">/</span>2;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">align</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Align</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RIGHT</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">offsetX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">availWidth</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">lineLength</span>;
                
            <span class="ActionScriptDefault_Text">lng</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lineArray</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            
            <span class="ActionScriptComment">// Loop through the cells in the line and draw
</span>            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lng</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">cellVO</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lineArray</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">CellVO</span>;

                <span class="ActionScriptDefault_Text">currentX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">offsetX</span>;
                <span class="ActionScriptDefault_Text">currentY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">offsetY</span>;

                <span class="ActionScriptDefault_Text">setFont</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontFamily</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontStyle</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fontSizePt</span> <span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// TODO: add support for character space
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">textColor</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">colorFlag</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">fillColor</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">addTextColor</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">addCell</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">border</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptOperator">,</span> <span class="ActionScriptString">""</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fill</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cellVO</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">link</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>     
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">parseTags</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">myXML</span> : <span class="ActionScriptDefault_Text">XML</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Array</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">aTags</span>    : <span class="ActionScriptDefault_Text">Array</span>     <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">children</span> : <span class="ActionScriptDefault_Text">XMLList</span>   <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">myXML</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">children</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">returnedLng</span>:<span class="ActionScriptDefault_Text">int</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span> : <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lng</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>

                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    
                    <span class="ActionScriptDefault_Text">aTags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">HTMLTag</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">'&lt;'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toUpperCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptComment">//Recurse into this tag and return them all as an array
</span>                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">returnedTags</span>    : <span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseTags</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">returnedLng</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">returnedTags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
                    
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span> : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">returnedLng</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">aTags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">returnedTags</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">)</span>;
                        
                    <span class="ActionScriptDefault_Text">aTags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">HTMLTag</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toUpperCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">aTags</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">HTMLTag</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">"none"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">XMLList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">aTags</span>;
        <span class="ActionScriptBracket/Brace">}</span>        
        
        <span class="ActionScriptASDoc">/**
        * Lets you activate the auto pagination mode
        *
        * @param activate Activate the auto pagination mode
        * @example
        * This example shows how to activate the auto pagination mode :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.setAutoPagination ( true );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setAutoPagination</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">activate</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">autoPagination</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">activate</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">autoPagination</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">activate</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF data API
        *
        * addGrid()
        *
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addGrid</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">grid</span>:<span class="ActionScriptDefault_Text">Grid</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">repeatHeader</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptDefault_Text">currentGrid</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">grid</span>;
            <span class="ActionScriptDefault_Text">currentGrid</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">x</span>;
            <span class="ActionScriptDefault_Text">currentGrid</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">y</span>;
            <span class="ActionScriptDefault_Text">columns</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentGrid</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">columns</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">buffer</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">grid</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dataProvider</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">columns</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">firstItem</span>:<span class="ActionScriptOperator">*</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fields</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">column</span>:<span class="ActionScriptDefault_Text">GridColumn</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">firstItem</span> <span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">fields</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">fields</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sort</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">columns</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fieldsLng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fields</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">fieldsLng</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">GridColumn</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">fields</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fields</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> 30 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">row</span>:<span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptDefault_Text">columnNames</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lngColumns</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;    
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">item</span>:<span class="ActionScriptOperator">*</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lngColumns</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">columnNames</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">headerText</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rect</span>:<span class="ActionScriptDefault_Text">Rectangle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getRect</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">columnNames</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">checkPageBreak</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">addPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">beginFill</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">grid</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">headerColor</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">setXY</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">getX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">getY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">addRow</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">columnNames</span><span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rect</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">endFill</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lng</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">item</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lngColumns</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">item</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dataField</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">item</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dataField</span><span class="ActionScriptBracket/Brace">]</span> : <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">nb</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">nbLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptDefault_Text">rect</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getRect</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">setX</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">getX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">checkPageBreak</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">addPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">setXY</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">getX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">getY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">repeatHeader</span> <span class="ActionScriptBracket/Brace">)</span> 
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">beginFill</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">grid</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">headerColor</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">addRow</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">columnNames</span><span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">getRect</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">columnNames</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">endFill</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">setX</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">getX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
        
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">grid</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">alternateRowColor</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isEven</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&amp;</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">beginFill</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">grid</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">backgroundColor</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">addRow</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rect</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">endFill</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">addRow</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rect</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getRect</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">rows</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Rectangle</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nb</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rows</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">lng</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">nb</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">nbLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">rows</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ph</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 5;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">h</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ph</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">nb</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">a</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            
               <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addRow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">data</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">style</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rect</span>:<span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">a</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ph</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 5;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">h</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">lng</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">a</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">style</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cellAlign</span> : <span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">headerAlign</span>;
                <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">rect</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">columns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>;
                <span class="ActionScriptDefault_Text">drawRect</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">rect</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">addMultiCell</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">ph</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">a</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">setXY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">newLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">checkPageBreak</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">getY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">&gt;</span><span class="ActionScriptDefault_Text">pageBreakTrigger</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">nbLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">int</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cw</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cw</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">rMargin</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">lMargin</span>;
           
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">wmax</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">-</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">cMargin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>1000<span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">fontSize</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findAndReplace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\r"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nb</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
           
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptOperator">&gt;</span>0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">charAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">==</span><span class="ActionScriptString">"\n"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptOperator">--</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sep</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>-1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nl</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>1;
            
            <span class="ActionScriptReserved">while</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">charAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">==</span><span class="ActionScriptString">"\n"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span>-1;
                    <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">=</span>0;
                    <span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">==</span><span class="ActionScriptString">' '</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">cw</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">&gt;</span><span class="ActionScriptDefault_Text">wmax</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">==</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                        <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">+</span>1;
                    <span class="ActionScriptDefault_Text">sep</span><span class="ActionScriptOperator">=</span>-1;
                    <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">=</span>0;
                    <span class="ActionScriptDefault_Text">nl</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">nl</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF saving API
        *
        * save()
        * textStyle()
        * addCell()
        * addMultiCell()
        * writeText()
        *
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>
        <span class="ActionScriptASDoc">/**
        * 
        *
        * @param method Can be se to Method.LOCAL, the savePDF will return the PDF ByteArray. When Method.REMOTE is passed, just specify the path to the create.php file
        * @param url The url of the create.php file
        * @param downloadMethod Lets you specify the way the PDF is going to be available. Use Download.INLINE if you want the PDF to be opened in the browser, use Download.ATTACHMENT if you want to make it available with a save-as dialog box
        * @param fileName The name of the PDF, only available when Method.REMOTE is used
        * @return The ByteArray PDF when Method.LOCAL is used, otherwise the method returns null
        * @example
        * This example shows how to save the PDF on the desktop with the AIR runtime :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * var f:FileStream = new FileStream();
          * file = File.desktopDirectory.resolvePath("generate.pdf");
          * f.open( file, FileMode.WRITE);
          * var bytes:ByteArray = myPDF.save( Method.LOCAL );
          * f.writeBytes(bytes);
          * f.close(); 
        * &lt;/pre&gt;
        * &lt;/div&gt;
        * 
        * This example shows how to save the PDF through a download dialog-box with Flash or Flex :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.save( Method.REMOTE, "http://localhost/save.php", Download.ATTACHMENT );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        * 
        * This example shows how to view the PDF in the browser with Flash or Flex :
        * &lt;div class="listing"&gt;
        * &lt;pre&gt;
        *
        * myPDF.save( Method.REMOTE, "http://localhost/save.php", Download.INLINE );
        * &lt;/pre&gt;
        * &lt;/div&gt;
        * 
        */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">save</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">method</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">url</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">downloadMethod</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'inline'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">fileName</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">'output.pdf'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">frame</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"_blank"</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptOperator">*</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ProcessingEvent</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">ProcessingEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">STARTED</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">started</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">finish</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ProcessingEvent</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">ProcessingEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">getTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">started</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">output</span>:<span class="ActionScriptOperator">*</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            
            <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">method</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">Method</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LOCAL</span> : 
                    <span class="ActionScriptDefault_Text">output</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buffer</span>;
                    <span class="ActionScriptReserved">break</span>;    
                
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">Method</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BASE_64</span> : 
                    <span class="ActionScriptDefault_Text">output</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Base64</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">encode64</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">buffer</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">break</span>;
                    
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">Method</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">REMOTE</span> :
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">header</span>:<span class="ActionScriptDefault_Text">URLRequestHeader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLRequestHeader</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Content-type"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"application/octet-stream"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">myRequest</span>:<span class="ActionScriptDefault_Text">URLRequest</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLRequest</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'?name='</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">fileName</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&amp;method='</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">downloadMethod</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">myRequest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">requestHeaders</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">header</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">myRequest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">method</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">URLRequestMethod</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">POST</span>;
                    <span class="ActionScriptDefault_Text">myRequest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buffer</span>;
                    <span class="ActionScriptDefault_Text">navigateToURL</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">myRequest</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">frame</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">break</span>;
                    
                <span class="ActionScriptReserved">default</span>:
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Unknown Method \""</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">method</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"\""</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">output</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * AlivePDF image API
        *
        * addImage()
        * textStyle()
        * addCell()
        * addMultiCell()
        * writeText()
        *
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        
        <span class="ActionScriptASDoc">/**
         * The addImage method takes an incoming DisplayObject. A JPG or PNG snapshot is done and included in the PDF document
         * 
         * @param displayObject
         * @param x
         * @param y
         * @param width
         * @param height
         * @param imageFormat
         * @param quality
         * @param alpha
         * @param resizeMode
         * @param blendMode
         * @param keepTransformation
         * @param link
         * @example
         * This example shows how to add a 100% compression quality JPG image into the current page at a position of 0,0 with no resizing behavior :
         * &lt;div class="listing"&gt;
         * &lt;pre&gt;
         *
         * myPDF.addImage ( displayObject, 0, 0, 0, 0, ImageFormat.JPG, 100, .2 );
         * &lt;/pre&gt;
         * &lt;/div&gt;
         */</span>     
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addImage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">displayObject</span>:<span class="ActionScriptDefault_Text">DisplayObject</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">imageFormat</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"PNG"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">quality</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>100<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">alpha</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resizeMode</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"None"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blendMode</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"Normal"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">keepTransformation</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">link</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bytes</span>:<span class="ActionScriptDefault_Text">ByteArray</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bitmapDataBuffer</span>:<span class="ActionScriptDefault_Text">BitmapData</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitmapData</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">displayObject</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">displayObject</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">bitmapDataBuffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">draw</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">displayObject</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">keepTransformation</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">displayObject</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">matrix</span> : <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">imageFormat</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">ImageFormat</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PNG</span> <span class="ActionScriptBracket/Brace">)</span> 
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">bytes</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">PNGEncoder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">encode</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">bitmapDataBuffer</span><span class="ActionScriptOperator">,</span> 1 <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">encoder</span>:<span class="ActionScriptDefault_Text">JPEGEncoder</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">JPEGEncoder</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">quality</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">bytes</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">encoder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">encode</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">bitmapDataBuffer</span> <span class="ActionScriptBracket/Brace">)</span>; 
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">addImageStream</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">bytes</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resizeMode</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blendMode</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">keepTransformation</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">link</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * The addImageStream method takes an incoming image as a ByteArray. This method can be used to embed high-quality images (300 dpi) to the PDF
         * 
         * @param imageBytes
         * @param x
         * @param y
         * @param width
         * @param height
         * @param alpha
         * @param resizeMode
         * @param blendMode
         * @param keepTransformation
         * @param link
         * @example
         * This example shows how to add an image as a ByteArray into the current page with a page resize behavior :
         * &lt;div class="listing"&gt;
         * &lt;pre&gt;
         *
         * myPDF.addImageStream( bytes, 0, 0, 0, 0, 1, ImageResize.RESIZE_PAGE );
         * &lt;/pre&gt;
         * &lt;/div&gt;
         */</span>     
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addImageStream</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">imageBytes</span>:<span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">alpha</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">resizeMode</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"None"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blendMode</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"Normal"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">keepTransformation</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">link</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">isMask</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">setAlpha</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">blendMode</span> <span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">streamDictionary</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">imageBytes</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">imageBytes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span> <span class="ActionScriptOperator">=</span> 0;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">id</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getNumImages</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">streamDictionary</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span>1;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">imageBytes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">readUnsignedShort</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">ImageHeader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">JPG</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">image</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">JPEGImage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">imageBytes</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">id</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">imageBytes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">imageBytes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">readUnsignedShort</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">ImageHeader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PNG</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">image</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PNGImage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">imageBytes</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">id</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Image format not supported for now."</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptDefault_Text">streamDictionary</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">imageBytes</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">image</span>;

            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">image</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">streamDictionary</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">imageBytes</span><span class="ActionScriptBracket/Brace">]</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">k</span>;
                <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">k</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">resizeMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">ResizeMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RESIZE_PAGE</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">resize</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">wPt</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">k</span>;
                <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hPt</span><span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">k</span>;

            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">resizeMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">ResizeMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FIT_TO_PAGE</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>        
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ratio</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">min</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">ratio</span>;
                <span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">ratio</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'q %.2f 0 0 %.2f %.2f %.2f cm'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/I%d Do Q'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">link</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">addLink</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">height</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">link</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">toString</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptString">"[PDF totalPages="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">totalPages</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">" pdfVersion="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">pdfVersion</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">" alivepdfVersion="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">PDF</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ALIVEPDF_VERSION</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"]"</span>;    
        <span class="ActionScriptBracket/Brace">}</span> 

        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>        <span class="ActionScriptComment">/*
        * protected members
        */</span>
        <span class="ActionScriptComment">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">finish</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">state</span> <span class="ActionScriptOperator">&lt;</span> 3 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">close</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setUnit</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">unit</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">unit</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Unit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">POINT</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 1;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">unit</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Unit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MM</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 72<span class="ActionScriptOperator">/</span>25.4;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">unit</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Unit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CM</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 72<span class="ActionScriptOperator">/</span>2.54;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">unit</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Unit</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">INCHES</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 72;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RangeError</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'Incorrect unit: '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">unit</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">unit</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">acceptPageBreak</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">autoPageBreak</span>;    
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">curve</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x1</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y1</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x2</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y2</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x3</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y3</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">h</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span>;

            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f %.2f %.2f %.2f %.2f c '</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x1</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y1</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x2</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y2</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">x3</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y3</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getStringWidth</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">content</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">cw</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cw</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            
            <span class="ActionScriptComment">// TBO
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cwAux</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> 
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">cwAux</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">cw</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">charAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Number</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">isNaN</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">cwAux</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">cwAux</span> <span class="ActionScriptOperator">=</span> 580;
            <span class="ActionScriptBracket/Brace">}</span>
                        
            <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">cwAux</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span><span class="ActionScriptOperator">/</span>1000;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">open</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">state</span> <span class="ActionScriptOperator">=</span> 1;    
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">close</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">state</span> <span class="ActionScriptOperator">==</span> 3 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">addPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">inFooter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">footer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">inFooter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">finishPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">finishDocument</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;    
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addExtGState</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">graphicState</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">int</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">extgstates</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">graphicState</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">extgstates</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">-</span>1;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setExtGState</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">graphicState</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/GS%d gs'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">graphicState</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;    
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">insertExtGState</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">extgstates</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lng</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">extgstates</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">n</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;/Type /ExtGState'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">extgstates</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">extgstates</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getChannels</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">&amp;</span> 0xFF0000<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">g</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">&amp;</span> 0x00FF00<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">&amp;</span> 0x0000FF<span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">/</span> 255<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">g</span> <span class="ActionScriptOperator">/</span> 255<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">" "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">b</span> <span class="ActionScriptOperator">/</span> 255<span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getCurrentDate</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">myDate</span>:<span class="ActionScriptDefault_Text">Date</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Date</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">year</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getFullYear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">month</span>:<span class="ActionScriptOperator">*</span>=<span class="ActionScriptOperator"> </span><span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getMonth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;</span> 10 <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">"0"</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getMonth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getMonth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span>1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">day</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getDate</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hours</span>:<span class="ActionScriptOperator">*</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getHours</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;</span> 10 <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">"0"</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getHours</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> : <span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getHours</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentDate</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getFullYear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">month</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">day</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">hours</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">''</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">myDate</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getMinutes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">currentDate</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">findAndReplace</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">search</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">replace</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">source</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">source</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">search</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">replace</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">createPageTree</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">nb</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">aliasNbPages</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">nb</span>; <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findAndReplace</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">aliasNbPages</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">nb</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptDefault_Text">filter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">compress</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">'/Filter /FlateDecode '</span> : <span class="ActionScriptString">''</span>;

            <span class="ActionScriptDefault_Text">offsets</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'1 0 obj'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;/Type /Pages'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Kids ['</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">references</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">']'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Count '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">nb</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">page</span>:<span class="ActionScriptDefault_Text">Page</span>;

            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">nb</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">page</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;/Type /Page'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Parent 1 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/MediaBox [0 0 %.2f %.2f]'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Resources 2 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">annotations</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Annots ['</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">annotations</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">']'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Rotate '</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rotation</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Dur '</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">transitions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">transitions</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Contents '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
          
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">compress</span> <span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">compressedPages</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptComment">//compressedPages.writeMultiByte( page.content+"\n", "windows-1252" );
</span>                    <span class="ActionScriptDefault_Text">compressedPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeUTFBytes</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"\n"</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">compressedPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">compress</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">filter</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'/Length '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">compressedPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'stream'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeBytes</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">compressedPages</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeUTFBytes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\n"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endstream'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;                    
                <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> 
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">filter</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'/Length '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeStream</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">substr</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">page</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeXObjectDictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">image</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">streamDictionary</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/I'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeResourcesDictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Font &lt;&lt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">font</span>:<span class="ActionScriptOperator">*</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">fonts</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/F'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/XObject &lt;&lt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeXObjectDictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/ExtGState &lt;&lt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">extgstates</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/GS'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">extgstates</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">insertImages</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">filter</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">compress</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">'/Filter /FlateDecode '</span> : <span class="ActionScriptString">''</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">stream</span>:<span class="ActionScriptDefault_Text">ByteArray</span>;

            <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">image</span>:<span class="ActionScriptDefault_Text">PDFImage</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">streamDictionary</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">n</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;/Type /XObject'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Subtype /Image'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Width '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Height '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cs</span> <span class="ActionScriptOperator">==</span><span class="ActionScriptString">'Indexed'</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/ColorSpace [/Indexed /DeviceRGB '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">PNGImage</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pal</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">/</span>3<span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R]'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/ColorSpace /'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cs</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cs</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">'DeviceCMYK'</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Decode [1 0 1 0 1 0 1 0]'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/BitsPerComponent '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bpc</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">f</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Filter /'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">f</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">image</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">PNGImage</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">image</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">GIFImage</span> <span class="ActionScriptBracket/Brace">)</span>        
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parameters</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parameters</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">trns</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">trns</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">trns</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">''</span>;
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lng</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">trns</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">lng</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">trns</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">trns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">trns</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span>;
                        <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Mask ['</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">trns</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">']'</span><span class="ActionScriptBracket/Brace">)</span>;    
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptDefault_Text">stream</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bytes</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Length '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">stream</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'stream'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeBytes</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">stream</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeUTFBytes</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\n"</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"endstream"</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cs</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">'Indexed'</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pal</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">compress</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">PNGImage</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pal</span> : <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">PNGImage</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pal</span>
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">filter</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'/Length '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">pal</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeStream</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pal</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">insertFonts</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nf</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">n</span>;

            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">diff</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">diffs</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;/Type /Encoding /BaseEncoding /WinAnsiEncoding /Differences ['</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">diff</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">']&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">type</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">name</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">font</span>:<span class="ActionScriptDefault_Text">Object</span>;

            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">fonts</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">font</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">fonts</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span>1;
                
                <span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">type</span>;
                <span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span>;

                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">FontType</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CORE</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">//Standard font
</span>                    <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;/Type /Font'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/BaseFont /'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Subtype /Type1'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptString">'Symbol'</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">FontFamily</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ZAPFDINGBATS</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Encoding /WinAnsiEncoding'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">FontType</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TYPE1</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">FontType</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TRUETYPE</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">//Additional Type1 or TrueType font
</span>                    <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;/Type /Font'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/BaseFont /'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Subtype /'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">type</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/FirstChar 32 /LastChar 255'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Widths '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/FontDescriptor '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">enc</span> <span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">diff</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Encoding '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nf</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">diff</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Encoding /WinAnsiEncoding'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>

                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptComment">//Widths
</span>                    <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cw</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">cw</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'['</span>;
                    <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>32; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;=</span>255; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">cw</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromCharCode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">']'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptComment">//Descriptor
</span>                    <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'&lt;&lt;/Type /FontDescriptor /FontName /'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">name</span>;
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">q</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">desc</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">' /'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">q</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">desc</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">q</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">file</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">font</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">file</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">file</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+=</span><span class="ActionScriptString">' /FontFile'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">==</span><span class="ActionScriptString">'Type1'</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">''</span> : <span class="ActionScriptString">'2'</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">fontFiles</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">file</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Unsupported font type: "</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeResources</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">insertExtGState</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">insertFonts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">insertImages</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">offsets</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'2 0 obj'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeResourcesDictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">insertBookmarks</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">insertBookmarks</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nb</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">nb</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lru</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">level</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">o</span>:<span class="ActionScriptDefault_Text">Object</span>;

            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">outlines</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">o</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;

                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">parent</span>:<span class="ActionScriptOperator">*</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lru</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">//Set parent and last pointers
</span>                    <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">parent</span>;
                    <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">last</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">level</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">//Level increasing: set first pointer
</span>                        <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">first</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">nb</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">level</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">//Set prev and next pointers
</span>                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">prev</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">lru</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">prev</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">prev</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">lru</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">i</span>;
                <span class="ActionScriptDefault_Text">level</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">l</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">//Outline items
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">n</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span>1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">Object</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">outlines</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;/Title '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Parent '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Prev '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prev</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Next '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">next</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">first</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/First '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">first</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">last</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Last '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">last</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/C ['</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">redMultiplier</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">greenMultiplier</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">blueMultiplier</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">']'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Dest [%d 0 R /XYZ 0 %.2f null]'</span><span class="ActionScriptOperator">,</span>1<span class="ActionScriptOperator">+</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Count 0&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptComment">//Outline root
</span>            <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">outlineRoot</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">n</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;/Type /Outlines /First '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Last '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">lru</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">insertInfos</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Producer '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'Alive PDF '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">PDF</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ALIVEPDF_VERSION</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentTitle</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Title '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentTitle</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentSubject</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Subject '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentSubject</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentAuthor</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Author '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentAuthor</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentKeywords</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Keywords '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentKeywords</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentCreator</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Creator '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">documentCreator</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/CreationDate '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'D:'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">getCurrentDate</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">createCatalog</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Type /Catalog'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Pages 1 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">zoomMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FULL_PAGE</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/OpenAction [3 0 R /Fit]'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">zoomMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FULL_WIDTH</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/OpenAction [3 0 R /FitH null]'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">zoomMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">REAL</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/OpenAction [3 0 R /XYZ null null '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">zoomFactor</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">']'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">zoomRectangle</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">zoomMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RECTANGLE</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/OpenAction [3 0 R /FitR '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">zoomRectangle</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">left</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">zoomRectangle</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bottom</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">zoomRectangle</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">right</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">zoomRectangle</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">top</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">']'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">zoomMode</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/OpenAction [3 0 R /XYZ null null '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">zoomMode</span><span class="ActionScriptOperator">/</span>100<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">']'</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/PageLayout /'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">layoutMode</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">viewerPreferences</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">viewerPreferences</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Outlines '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">outlineRoot</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/PageMode /UseOutlines'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">createHeader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%PDF-'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">pdfVersion</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">createTrailer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Size '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Root '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'/Info '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 R'</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">finishDocument</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">pageMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">PageMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">USE_ATTACHMENTS</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">pdfVersion</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"1.6"</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">layoutMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Layout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TWO_PAGE_LEFT</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">layoutMode</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">Layout</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TWO_PAGE_RIGHT</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">pdfVersion</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"1.5"</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">extgstates</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">pdfVersion</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptString">"1.4"</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">pdfVersion</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"1.4"</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">outlines</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">pdfVersion</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"1.4"</span>;
            
            <span class="ActionScriptDefault_Text">createHeader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">started</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">createPageTree</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ProcessingEvent</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">ProcessingEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PAGE_TREE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">getTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">started</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">started</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">writeResources</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ProcessingEvent</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">ProcessingEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RESOURCES</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">getTimer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">started</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//Info
</span>            <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">insertInfos</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//Catalog
</span>            <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">createCatalog</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endobj'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//Cross-ref
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">o</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'xref'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0 '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'0000000000 65535 f '</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>1;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;=</span><span class="ActionScriptDefault_Text">n</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%010d 00000 n '</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">offsets</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//Trailer
</span>            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'trailer'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;&lt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">createTrailer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&gt;&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'startxref'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%%EOF'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">state</span> <span class="ActionScriptOperator">=</span> 3;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">startPage</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">newOrientation</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Page</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">nbPages</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptDefault_Text">state</span> <span class="ActionScriptOperator">=</span> 2;
            <span class="ActionScriptDefault_Text">setXY</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lMargin</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tMargin</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">fontFamily</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">''</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">newOrientation</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">''</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">newOrientation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">defaultOrientation</span>;
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">newOrientation</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">defaultOrientation</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">orientationChanges</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">nbPages</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            
            <span class="ActionScriptDefault_Text">pageBreakTrigger</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">nbPages</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">bMargin</span>;
            <span class="ActionScriptDefault_Text">currentOrientation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newOrientation</span>;
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">arrayPages</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">nbPages</span><span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">]</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">finishPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">state</span> <span class="ActionScriptOperator">=</span> 1;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">newObj</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">offsets</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptOperator">++</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptDefault_Text">write</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">' 0 obj'</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">doUnderline</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">content</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">up</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">up</span>
            <span class="ActionScriptDefault_Text">ut</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentFont</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ut</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getStringWidth</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">ws</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">substrCount</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">' '</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">sprintf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'%.2f %.2f %.2f %.2f re f'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">up</span><span class="ActionScriptOperator">/</span>1000<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSize</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">,</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">ut</span><span class="ActionScriptOperator">/</span>1000<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">fontSizePt</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

       <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">substrCount</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">content</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">search</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">int</span>
       <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">split</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">search</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;    
       <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getNumImages</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">object</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">int</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">num</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">num</span><span class="ActionScriptOperator">++</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">num</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">escapeString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">content</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptString">'('</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">escape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">')'</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">escape</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">content</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">findAndReplace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">')'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">'\\)'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">findAndReplace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'('</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">'\\('</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">findAndReplace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'\\'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">'\\\\'</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeStream</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">stream</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'stream'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">stream</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'endstream'</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">content</span>:<span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">currentPage</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"No pages available, please call the addPage method first !"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">state</span> <span class="ActionScriptOperator">==</span> 2 <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">currentPage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">content</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"\n"</span>;
            <span class="ActionScriptComment">//else buffer.writeMultiByte( content+"\n", "windows-1252" );
</span>            <span class="ActionScriptDefault_Text">buffer</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeUTFBytes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"\n"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">//--
</span>        <span class="ActionScriptComment">//-- IEventDispatcher
</span>        <span class="ActionScriptComment">//--
</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">useCapture</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">priority</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">useWeakReference</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">useCapture</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">priority</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">useWeakReference</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">event</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">hasEventListener</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hasEventListener</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">useCapture</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">useCapture</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">willTrigger</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">dispatcher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">willTrigger</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span>
</pre></body>
</html>
